webpackJsonp([2],{1128:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function h(e){var t=e.captcha;return{captchaNeeded:t.captchaNeeded,captchaUrl:"data:image/jpg;base64,"+t.captchaBase64String}}function d(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function g(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function S(e,t,n,r){wn.default.trackEvent(e,{action:t,element:"Button",element_name:r},{account:n})}function C(e,t,n,r){wn.default.trackEvent(e,{action:"StatusReport",element_name:r},{status:{result:"Success",event:{action:t,element:"Button"}},account:n})}function O(e,t,n,r,o){var a="object"===(void 0===r?"undefined":En(r))?Object.keys(r).map(function(e){return"object"===En(r[e])?r[e].message:r[e]}):[r];wn.default.trackEvent(e,{action:"StatusReport",element_name:o},{status:{result:"Fail",error_msg:a,event:{action:t,element:"Button"}},account:n})}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function N(e){var t=e.register,n=t.registerValidateSucceeded,r=t.registerConfirmSucceeded,o=t.registerValidateErrors,a=t.registerConfirmError;return{registerValidateSucceeded:n,registerConfirmSucceeded:r,registerValidateErrors:o,captchaValidationMessage:e.captcha.captchaValidationMessage,registerConfirmError:a}}function j(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function I(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function M(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function V(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function L(e){var t=e.register;return{registerConfirmError:t.registerConfirmError,sendDigitsError:t.sendDigitsError,registerConfirmSucceeded:t.registerConfirmSucceeded}}function U(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Q(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function Y(e){return{hasCode:e.startsWith("+")||e.startsWith("00"),parsedPhoneNo:e.startsWith("00")?"+"+e.slice(2):e}}function X(e,t){if(!e)return{};var n=e,r=Q(e);if(!r){var o=Y(e),a=o.hasCode,i=o.parsedPhoneNo;n=a?i:""+t+e}return{value:n,isEmail:r}}function Z(e,t){var n=Date.now(),r=new er.a("SHA-1","TEXT");return r.setHMACKey("d1b964811afb40118a12068ff74a12f4","TEXT"),r.update(e),r.update(tr.a),r.update("com.zhihu.web"),r.update(String(n)),nr({clientId:tr.a,grantType:e,timestamp:n,source:"com.zhihu.web",signature:r.getHMAC("HEX")},t)}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ee(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function te(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function ne(e){var t=e.login;return{qrcodeLoginToken:t.qrcodeLoginToken,qrcodeLoginScanStatus:t.qrcodeLoginScanStatus,qrcodeLoginError:t.qrcodeLoginError,qrcodeLoginReturnNewToken:t.qrcodeLoginReturnNewToken,token:e.token}}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ae(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ie(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function se(e){var t=e.captcha,n=t.captchaValidationMessage,r=t.captchaNeeded,o=e.login;return{loginConfirmSucceeded:o.loginConfirmSucceeded,loginConfirmError:o.loginConfirmError,sendDigitsError:o.sendDigitsError,captchaValidationMessage:n,captchaNeeded:r}}function ce(e){return{module:"digits"===e.type?"SMSSignInForm":"SignInForm"}}function ue(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pe(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function fe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function he(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function de(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function be(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function we(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Ee(e){var t=e.active;return{sendDigitsError:t.sendDigitsError,activeConfirmSucceeded:t.activeConfirmSucceeded,activeConfirmError:t.activeConfirmError}}function Se(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function Ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oe(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ke(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Te(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function Pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ne(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function je(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _e(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Re(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Ie(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var De,Be,Me,Fe,xe,Ve,Le,Ue,qe,He,We,ze,Qe,Ye,Xe,Ze,Ke,Ge,Je,$e,et,tt,nt,rt,ot,at,it,st,ct,ut,lt,pt,ft,ht,dt,mt,bt,yt,gt,vt,wt,Et,St,Ct,Ot,kt,Tt,Pt,Nt,jt,_t,At,Rt,It=n(1),Dt=n.n(It),Bt=n(0),Mt=n.n(Bt),Ft=n(3),xt=n(4),Vt=n(388),Lt=n(373),Ut=n(6),qt=n(11),Ht=n(152),Wt=n(2),zt=n.n(Wt),Qt=n(1129),Yt=n(5),Xt=(n(1132),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()),Zt=(Be=De=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),a.state={hovered:!0},a.handleMouseEnter=function(){a.setState({hovered:!0})},a.handleMouseLeave=function(){a.setState({hovered:!1})},i=n,o(a,i)}return a(t,e),Xt(t,[{key:"componentWillReceiveProps",value:function(e){this.props.position!==e.position&&this.handleMouseLeave()}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.position!==e.position||this.state.hovered!==t.hovered}},{key:"render",value:function(){var e=this.props,t=e.position,n=e.onUnMark,r=this.state.hovered;return Mt.a.createElement(xt.default,{className:"ChineseCaptchaPoint",style:t,onClick:n,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,preset:"plain"},Mt.a.createElement(Yt.default,{name:"captchaPointCircle",className:zt()("ChineseCaptchaPoint-backIcon",{"ChineseCaptchaPoint-backIcon--hovered":r}),fill:r?"#0f88eb":"#aad9ff",width:20,height:20}),Mt.a.createElement(Yt.default,{name:r?"captchaPointCancel":"captchaPointCircle",className:zt()("ChineseCaptchaPoint-frontIcon",{"ChineseCaptchaPoint-frontIcon--hovered":r}),fill:r?"#ffffff":"#0f88eb",width:r?8:12,height:r?8:12}))}}]),t}(Bt.Component),De.propTypes={onUnMark:Dt.a.func.isRequired,position:Dt.a.object.isRequired},Be),Kt=Zt,Gt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Jt=7,$t=10,en="最多只能选择 "+Jt+" 个点",tn=60,nn=(Fe=Me=function(e){function t(){var e,n,r,o;s(this,t);for(var a=arguments.length,u=Array(a),l=0;l<a;l++)u[l]=arguments[l];return n=r=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.state={markPositionsArray:[]},r.handleMarkPoint=function(e){if(r.chineseCaptchaImg){var t=r.state.markPositionsArray,n=r.props.onValidation;if(t.length>=Jt)return void n({validationMessage:en});var o=e.pageX,a=e.pageY,s=r.chineseCaptchaImg.getBoundingClientRect(),c=s.top,u=s.left,l=a-c-window.pageYOffset-$t,p=o-u-window.pageXOffset-$t,f=[].concat(i(t),[{top:l,left:p+tn}]);r.updateMarkPoint(f)}},r.handleUnMarkPoint=function(e){var t=[].concat(i(r.state.markPositionsArray));t.splice(e,1),r.updateMarkPoint(t)},r.updateMarkPoint=function(e){r.setState({markPositionsArray:e},function(){r.props.onUpdateInput(r.parseMarkPositionsArrayToInputValue(e))})},r.parseMarkPositionsArrayToInputValue=function(e){return JSON.stringify({img_size:[r.chineseImgWidth,r.chineseImgHeight],input_points:e.map(function(e){var t=e.top;return[e.left+$t-tn,t+$t]})})},o=n,c(r,o)}return u(t,e),Gt(t,[{key:"componentDidMount",value:function(){if(this.chineseCaptchaImg){var e=this.chineseCaptchaImg.getBoundingClientRect();this.chineseImgWidth=e.width,this.chineseImgHeight=e.height}}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.url!==e.url||this.props.validationMessage!==e.validationMessage||this.props.isShown!==e.isShown||this.state.markPositionsArray!==t.markPositionsArray}},{key:"renderCaptcha",value:function(){var e=this,t=this.props,n=t.url,r=t.isChinese,o=t.onRefresh;return n?Mt.a.createElement("div",{className:r?"Captcha-chineseContainer":"Captcha-englishContainer"},Mt.a.createElement("img",{"data-tooltip":"看不清楚？换一张",className:r?"Captcha-chineseImg":"Captcha-englishImg",src:n,alt:"图形验证码",onClick:r?this.handleMarkPoint:o,ref:r&&function(t){e.chineseCaptchaImg=t}}),r?this.state.markPositionsArray.map(function(t,n){return Mt.a.createElement(Kt,{key:n,onUnMark:function(){return e.handleUnMarkPoint(n)},position:t})}):null):null}},{key:"render",value:function(){var e=this.props,t=e.isChinese,n=e.onRefresh,r=e.validationMessage,o=e.className,a=e.onUpdateInput,i=e.validations,s=e.isShown,c=this.renderCaptcha(),u={width:"0",height:"0",opacity:"0",overflow:"hidden",margin:"0",padding:"0"};return Mt.a.createElement("div",{className:zt()("Captcha",o),style:s?{}:u},t?Mt.a.createElement("div",null,Mt.a.createElement("div",{className:"Captcha-chineseOperator"},Mt.a.createElement("span",{className:zt()("Captcha-info",{"Captcha-error":Boolean(r)})},r||"请点击图中倒立的文字"),Mt.a.createElement(xt.default,{className:"Captcha-chineseRefreshButton",preset:"plain",onClick:n})),c):Mt.a.createElement("div",null,Mt.a.createElement(Qt.a,{name:"captcha",type:"text",errorMessageClassName:"Captcha-errorMessage",placeholder:"验证码",onChange:a,validations:s?i:[],manualValidateError:r,tabIndex:s?0:-1}),Mt.a.createElement("span",{className:"Captcha-englishImage"},c)))}}]),t}(Bt.Component),Me.propTypes={isChinese:Dt.a.bool,url:Dt.a.string,validationMessage:Dt.a.string,onValidation:Dt.a.func,onRefresh:Dt.a.func.isRequired,onUpdateInput:Dt.a.func.isRequired,isShown:Dt.a.bool,validations:Dt.a.array},Me.defaultProps={isChinese:!1,isShown:!1,validations:[{type:"required",message:"请填写验证码",className:"Captcha-requiredErrorMessage"}]},Fe),rn=nn,on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},an=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),sn=(xe=Object(Ft.connect)(h,{checkIfCaptchaNeeded:Ht.c,requestForCaptcha:Ht.e,resetCaptchaInfo:Ht.f}))((Ue=Le=function(e){function t(){var e,n,r,o;l(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={validationMessage:""},r.handleValidation=function(e){var t=e.message,n=e.needsRefresh;void 0!==(void 0===t?"undefined":on(t))&&r.setState({validationMessage:t});var o=r.props,a=o.captchaNeeded,i=o.checkIfCaptchaNeeded,s=o.requestForCaptcha;!a&&n?i():n&&s()},o=n,p(r,o)}return f(t,e),an(t,[{key:"componentDidMount",value:function(){this.props.checkIfCaptchaNeeded()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.validationResult,r=void 0===n?{}:n,o=t.captchaNeeded,a=t.requestForCaptcha,i=e.validationResult,s=void 0===i?{}:i,c=e.captchaNeeded;!o&&c&&a(),r.timestamp!==s.timestamp&&this.handleValidation(s)}},{key:"componentWillUnmount",value:function(){this.props.resetCaptchaInfo()}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.isChinese,r=e.onUpdateInput,o=e.captchaNeeded,a=e.className,i=e.requestForCaptcha,s=e.captchaUrl,c=e.canCaptchaShown,u=this.state.validationMessage,l=c&&o,p="digitsLogin"!==t?rn.defaultProps.validations:[];return Mt.a.createElement(rn,{type:t,className:a,isShown:l,isChinese:n,url:s,validationMessage:u,onRefresh:i,onValidation:this.handleValidation,validations:p,onUpdateInput:r})}}]),t}(Bt.Component),Le.propTypes={canCaptchaShown:Dt.a.bool,isChinese:Dt.a.bool,type:Dt.a.oneOf(["login","digitsLogin","register"]).isRequired,validationResult:Dt.a.object,captchaNeeded:Dt.a.bool,captchaUrl:Dt.a.string,onUpdateInput:Dt.a.func,checkIfCaptchaNeeded:Dt.a.func,requestForCaptcha:Dt.a.func},Le.defaultProps={canCaptchaShown:!1,isChinese:!1},Ve=Ue))||Ve,cn=sn,un=cn,ln=n(1130),pn=n(1131),fn=n(41),hn=(n(1287),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),dn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),mn=(He=qe=function(e){function t(e){m(this,t);var n=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSwitchPasswordInputType=function(){n.setState(function(e){return{inputType:"password"===e.inputType?"text":"password"}})},n.handleChange=function(e){n.state.hasValue!==Boolean(e)&&n.setState({hasValue:Boolean(e)}),n.props.onChange(e)},n.state={hasValue:Boolean(e.defaultValue),inputType:e.defaultType},n}return y(t,e),dn(t,[{key:"render",value:function(){var e=Object(fn.omit)(this.props,"onChange","defaultType"),t=e.switchDisabled,n=e.placeholderPrefix,r=d(e,["switchDisabled","placeholderPrefix"]),o=this.state,a=o.inputType,i=o.hasValue;return Mt.a.createElement("div",{className:"SignFlow-password"},Mt.a.createElement(Qt.a,hn({name:"password",inputClassName:"password"===a&&i?"SignFlow-passwordInput":"",type:a,placeholder:(n||"")+"密码",onChange:this.handleChange,errorMessageClassName:"SignFlow-passwordErrorMask",validations:[{type:"required",message:"请输入密码",className:"SignFlow-requiredPasswordErrorMask"},{type:"minLength",value:6,message:"请输入 6-128 位密码"},{type:"maxLength",value:128,message:"请输入 6-128 位密码"}]},r)),!t&&Mt.a.createElement(xt.default,{className:"SignFlow-switchPassword",tabIndex:-1,preset:"plain",onClick:this.handleSwitchPasswordInputType},Mt.a.createElement(Yt.default,{className:"SignFlow-switchPasswordIcon",name:"password"===a?"inconspicuous":"read",width:24,height:20,style:{verticalAlign:"middle"}})))}}]),t}(Bt.Component),qe.propTypes={onChange:Dt.a.func.isRequired,switchDisabled:Dt.a.bool,defaultType:Dt.a.string},qe.defaultProps={defaultType:"password"},He),bn=(n(1288),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),yn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),gn=(ze=We=function(e){function t(){return v(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return E(t,e),yn(t,[{key:"render",value:function(){var e=this.props,t=e.onChange,n=g(e,["onChange"]);return Mt.a.createElement(Qt.a,bn({className:"SignFlow-username",onChange:t,validations:[{type:"required",message:"请输入用户名"}]},n))}}]),t}(Bt.Component),We.propTypes={onChange:Dt.a.func.isRequired},ze),vn=gn,wn=n(7),En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn={sina:"Weibo",qq:"QQ",wechat:"Wechat"},Cn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},On=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),kn=(Qe=Object(Ft.connect)(N,{validateRegister:Lt.e,resetRegisterValidateResult:Lt.c,validateSNSRegister:Lt.f}),Ye=Object(qt.a)({module:"SignUpForm"}),Qe(Xe=Ye((Ke=Ze=function(e){function t(){var e,n,r,o;k(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=T(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={validationResult:{}},r.checkAllInputFilled=function(){if(r.allInputFilled)return r.allInputFilled;var e=r.props,t=e.phoneNo,n=e.password,o=e.fullname,a=e.bySocial;return r.allInputFilled=(Boolean(t)||a)&&(Boolean(n)||a)&&Boolean(o),r.allInputFilled},r.handleSubmit=function(e){var t=r.props,n=t.validateRegister,o=t.validateSNSRegister,a=t.selectedCountry,i=t.captcha,s=t.bySocial,c=t.socialType,u=e.phoneNo,l=e.password,p=e.fullname,f=Object(Vt.b)(),h=f.atoken,d=f.atokenExpiredIn,m=f.clientId,b={accessToken:h,expiresAt:d,appkey:Ut.g[c],registerType:c,socialId:m,source:"com.zhihu.web"},y=s?Cn({fullname:p,captcha:i},b):{phoneNo:""+a.code+u,password:l,fullname:p,captcha:i};s?o(Cn({},y)):n(Cn({},y))},r.parseErrorMessages=function(){var e=r.props,t=e.registerValidateErrors,n=void 0===t?{}:t,o=e.onSwitch,a=e.selectedCountry,i=e.phoneNo,s=e.password,c=n.phoneNo,u=void 0===c?{}:c,l=n.fullname,p=void 0===l?{}:l,f=n.password,h=void 0===f?{}:f,d=u.code,m=u.message;return{phoneNoError:100028===d?Mt.a.createElement("span",null,"该手机号已注册 · ",Mt.a.createElement(xt.default,{preset:"plain",style:{color:"#3f3f3f"},onClick:function(){return o({selectedCountry:a,username:i,password:s})}},"直接登录")):m,fullnameError:p.message,passwordError:h.message}},r.handleLogSubmit=function(){S(r,"SignUp",r.buildZAAccount())},r.handleLogSubmitValidateError=function(e){O(r,"SignUp",r.buildZAAccount(),e)},o=n,T(r,o)}return P(t,e),On(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.registerValidateSucceeded,r=t.onSendDigits,o=t.captchaValidationMessage,a=t.registerConfirmSucceeded,i=e.bySocial,s=e.registerValidateSucceeded,c=e.captchaValidationMessage,u=e.registerConfirmSucceeded,l=e.registerConfirmError,p=e.registerValidateErrors;if(n!==s&&!1===s||a!==u&&!1===u)this.handleLogSubmitValidateError(l||p),this.setState({validationResult:{needsRefresh:!0,timestamp:Date.now()}});else if(n||!s||i)if(!a&&u){Object(Vt.a)(["atoken","atokenExpiredIn"]);var f=location,h=f.pathname,d=f.search,m=f.hash;location.href="/"+(h?"?next="+h:"")+d+m,this.handleLogSubmitSuccess()}else o!==c&&(this.setState({validationResult:{message:c,needsRefresh:Boolean(c),timestamp:Date.now()}}),c&&this.handleLogSubmitValidateError(c));else r(),this.handleLogSubmitSuccess()}},{key:"componentWillUnmount",value:function(){this.props.resetRegisterValidateResult(),Object(Vt.a)(["atoken","atokenExpiredIn"])}},{key:"buildZAAccount",value:function(){var e=this.props,t=e.phoneNo,n=e.selectedCountry.code,r=e.bySocial,o=e.socialType;return r?{type:Sn[o]}:{email:null,phone:t?""+n+t:null,type:"Zhihu"}}},{key:"handleLogSubmitSuccess",value:function(){C(this,"SignUp",this.buildZAAccount())}},{key:"render",value:function(){var e=this.props,t=e.onChange,n=e.phoneNo,r=e.fullname,o=e.password,a=e.selectedCountry,i=e.bySocial,s=this.parseErrorMessages(),c=s.phoneNoError,u=s.fullnameError,l=s.passwordError,p=this.state.validationResult;return Mt.a.createElement(ln.b,{className:"SignFlow",onSubmit:this.handleSubmit,onPreSubmit:this.handleLogSubmit,onInvalid:this.handleLogSubmitValidateError},!i&&Mt.a.createElement(pn.a,{type:"register",onSelect:function(e){return t("selectedCountry",e)},onChange:function(e){return t("phoneNo",e)},defaultPhoneNo:n,defaultSelectedCountry:a,manualValidateError:c}),!i&&Mt.a.createElement(mn,{onChange:function(e){return t("password",e)},defaultValue:o,manualValidateError:l}),Mt.a.createElement(vn,{onChange:function(e){return t("fullname",e)},name:"fullname",placeholder:"姓名",defaultValue:r,manualValidateError:u}),Mt.a.createElement(un,{className:"SignFlow-captchaContainer",canCaptchaShown:this.checkAllInputFilled(),type:"register",onUpdateInput:function(e){return t("captcha",e)},validationResult:p}),Mt.a.createElement(xt.default,{className:"SignFlow-submitButton",preset:"primary",color:"blue",type:"submit"},"注册"))}}]),t}(Bt.Component),Ze.propTypes={supportedCountries:Dt.a.array,registerValidateSucceeded:Dt.a.bool,registerValidateErrors:Dt.a.object,registerConfirmError:Dt.a.string,captchaValidationMessage:Dt.a.string,onSendDigits:Dt.a.func.isRequired,phoneNo:Dt.a.string,password:Dt.a.string,fullname:Dt.a.string,onChange:Dt.a.func.isRequired,captcha:Dt.a.string,bySocial:Dt.a.bool,socialType:Dt.a.string},Ze.defaultProps={bySocial:!1},Xe=Ke))||Xe)||Xe),Tn=kn,Pn=n(23),Nn=(n(1289),function(e){var t=e.title;return Mt.a.createElement("div",{className:"SignFlowModalHeader"},Mt.a.createElement("h1",{className:"SignFlowModalHeader-title"},t),Mt.a.createElement("h2",{className:"SignFlowModalHeader-subTitle"},"与世界分享你的知识、经验和见解"))}),jn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),An=(Je=Ge=function(e){function t(){var e,n,r,o;_(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=A(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.handleSwitch=function(){wn.default.trackEvent(r,{action:"Click",element:"Button",element_name:"SignIn"});var e=r.props,t=e.selectedCountry,n=e.phoneNo,o=e.password;(0,e.onSwitch)({selectedCountry:t,username:n,password:o})},o=n,A(r,o)}return R(t,e),_n(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.shown,r=e.onSwitch,o=j(e,["onClose","shown","onSwitch"]);return Mt.a.createElement(Pn.default,{onClose:t,maskClosable:!1,spread:!0},n&&Mt.a.createElement("div",null,Mt.a.createElement(Nn,{title:"加入知乎"}),Mt.a.createElement(Tn,jn({onSwitch:r},o)),Mt.a.createElement("div",{className:"SignFlowModal-registerFooter"},Mt.a.createElement("span",null,"注册即代表同意",Mt.a.createElement(xt.default,{preset:"plain",component:"a",target:"_blank",href:"/terms"},"《知乎协议》")),Mt.a.createElement("span",null,"已有帐号？",Mt.a.createElement(xt.default,{className:"SignFlowModal-switchButton",preset:"plain",onClick:this.handleSwitch,disabled:!n},"登录")))))}}]),t}(Bt.Component),Ge.propTypes={onClose:Dt.a.func.isRequired,shown:Dt.a.bool,onSwitch:Dt.a.func},Ge.defaultProps={shown:!1},Je),Rn=An,In=n(1133),Dn=n(1134),Bn=(n(1291),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Mn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Fn=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}([""," 秒后可重发"],[""," 秒后可重发"]),xn=(et=$e=function(e){function t(){return D(this,t),B(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return M(t,e),Mn(t,[{key:"render",value:function(){var e=this.props,t=e.countDownEvent,n=e.countDownEndEvent,r=e.startAtOnce,o=e.interceptTime,a=e.isEmail,i=e.reStartTime,s=e.smsType,c=I(e,["countDownEvent","countDownEndEvent","startAtOnce","interceptTime","isEmail","reStartTime","smsType"]),u=void 0;return u=a?"邮箱":"voice"===s?"语音":"短信",Mt.a.createElement("div",{className:"SignFlow SignFlow-smsInputContainer"},Mt.a.createElement(Qt.a,Bn({name:"digits",className:"SignFlow-smsInput",type:"number",smsType:s,errorMessageClassName:"SignFlow-smsInputErrorMessage",placeholder:"输入 6 位"+u+"验证码",validations:[{type:"required",message:"请输入"+u+"验证码",className:"SignFlow-smsInputRequiredErrorMask"}]},c)),Mt.a.createElement(In.a,{className:"SignFlow-smsInputButton",preset:"plain",initialText:"获取"+u+"验证码",resetText:"重新获取"+u+"验证码",countingText:Object(Dn.a)(Fn,"count"),startAtOnce:r,event:t,countDownEndEvent:n,interceptTime:o,reStartTime:i}))}}]),t}(Bt.Component),$e.propTypes={countDownEvent:Dt.a.func.isRequired,startAtOnce:Dt.a.bool,interceptTime:Dt.a.number,reStartTime:Dt.a.number,isEmail:Dt.a.bool,countDownEndEvent:Dt.a.func,smsType:Dt.a.string},$e.defaultProps={startAtOnce:!1,isEmail:!1},et),Vn=xn,Ln=n(369),Un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Hn=(tt=Object(Ft.connect)(L,{sendDigits:Lt.d,confirmRegister:Lt.a}))((ot=rt=function(e){function t(){var e,n,r,o;F(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=x(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={modalFooterContent:null,smsType:"text",smsBackUpName:"语音",reStartTime:-1,interceptTime:-1,sendSMSCodeCount:0,smsBackUpDisplay:!0},r.handleModalFooterStatus=function(e){r.setState({modalFooterContent:e})},r.handleChangeSmsType=function(){r.setState(function(e){var t=e.smsType;return{smsType:"text"===t?"voice":"text",smsBackUpName:"text"===t?"短信":"语音",reStartTime:Date.now()}})},r.handleCountDownEndEvent=function(){r.setState({smsBackUpDisplay:!0})},r.handleSubmit=function(e){var t=r.props,n=t.phoneNo,o=t.fullname,a=t.password;(0,t.confirmRegister)(Un({},e,{phoneNo:n,fullname:o,password:a,registerType:"phone_digits"}))},r.handleSendDigits=function(){var e=r.props,t=e.sendDigits,n=e.phoneNo,o=r.state,a=o.smsType,i=o.sendSMSCodeCount;t(n,a),0!==i&&r.setState({smsBackUpDisplay:!1}),r.setState(function(e){return{sendSMSCodeCount:e++}})},o=n,x(r,o)}return V(t,e),qn(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.sendDigitsError,n=e.sendDigitsError;if(!this.props.registerConfirmSucceeded&&e.registerConfirmSucceeded){Object(Ln.b)(this.props.phoneNo);var r=location,o=r.pathname,a=r.search,i=r.hash;location.href="/"+(o?"?next="+o:"")+a+i}!t&&n&&(this.setState({interceptTime:Date.now()}),this.handleCountDownEndEvent())}},{key:"render",value:function(){var e=this,t=this.props,n=t.phoneNo,r=t.onBack,o=t.registerConfirmError,a=t.sendDigitsError,i=t.onClose,s=t.shown,c=this.state,u=c.modalFooterContent,l=c.smsType,p=c.smsBackUpDisplay,f=c.smsBackUpName,h=c.reStartTime,d=c.interceptTime;return Mt.a.createElement(Pn.default,{onClose:i,footer:u},s?Mt.a.createElement("div",{className:"RegisterSMSCodeVerificationDialog"},Mt.a.createElement(xt.default,{className:"RegisterSMSCodeVerificationDialog-backButton",preset:"plain",onClick:r},Mt.a.createElement(Yt.default,{name:"arrowLeft",width:17,height:17})),Mt.a.createElement("div",{className:"RegisterSMSCodeVerificationDialog-header"},Mt.a.createElement("h1",{className:"RegisterSMSCodeVerificationDialog-title"},"验证手机"),Mt.a.createElement("h2",{className:"RegisterSMSCodeVerificationDialog-subtitle"},"请输入你收到的 6 位数验证码")),Mt.a.createElement(ln.b,{className:"RegisterSMSCodeVerificationDialog-form",onSubmit:this.handleSubmit},Mt.a.createElement("div",{className:"RegisterSMSCodeVerificationDialog-phoneNo"},n),Mt.a.createElement(Vn,{countDownEvent:function(){return e.handleSendDigits()},manualValidateError:a||o,countDownEndEvent:this.handleCountDownEndEvent,smsType:l,reStartTime:h,interceptTime:d,startAtOnce:!0}),Mt.a.createElement("div",{className:"RegisterSMSTypeOptions"},Mt.a.createElement(xt.default,{preset:"plain",className:"RegisterSMSTypeCut",onClick:this.handleChangeSmsType},p&&"接收"+f+"验证码")),Mt.a.createElement("div",{className:"RegisterSMSCodeVerificationDialog-buttonContainer"},Mt.a.createElement(xt.default,{className:"RegisterSMSCodeVerificationDialog-enterButton",preset:"primary",color:"blue",type:"submit"},"进入知乎")))):null)}}]),t}(Bt.Component),rt.PropTypes={phoneNo:Dt.a.string.isRequired,fullname:Dt.a.string.isRequired,password:Dt.a.string.isRequired,onBack:Dt.a.func,sendDigits:Dt.a.func,confirmRegister:Dt.a.func,registerConfirmError:Dt.a.string,modalFooterContentShown:Dt.a.bool,modalFooterContent:Dt.a.node,onClose:Dt.a.func.isRequired,shown:Dt.a.bool},rt.defaultProps={hasBackButton:!1,modalFooterContentShown:!1,modalFooterContent:null,shown:!1},nt=ot))||nt,Wn=Hn,zn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Yn={smsCodeVerificationShown:!1,phoneNo:"",password:"",fullname:"",captcha:"",selectedCountry:{name:"中国",code:"+86"}},Xn=(it=at=function(e){function t(){var e,n,r,o;H(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=W(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state=zn({},Yn),r.handleChange=function(e,t){r.setState(q({},e,t))},r.handleClose=function(){r.setState(zn({},Yn),function(){r.props.onClose()})},r.handleSendDigits=function(){r.setState(function(e){return{smsCodeVerificationShown:!e.smsCodeVerificationShown}})},r.renderSMSCodeVerification=function(){var e=r.state,t=e.selectedCountry.code,n=e.phoneNo,o=e.fullname,a=e.password,i=e.smsCodeVerificationShown;return Mt.a.createElement(Wn,{onClose:r.handleSendDigits,onBack:r.handleSendDigits,phoneNo:""+t+n,fullname:o,password:a,shown:i})},o=n,W(r,o)}return z(t,e),Qn(t,[{key:"render",value:function(){var e=this.props,t=e.isInModal,n=e.shown,r=U(e,["isInModal","shown"]),o=this.state,a=o.phoneNo,i=o.password,s=o.fullname,c=o.selectedCountry,u=o.captcha,l=o.smsCodeVerificationShown,p=zn({phoneNo:a,password:i,fullname:s,selectedCountry:c,captcha:u,onSendDigits:this.handleSendDigits,onChange:this.handleChange},r);return Mt.a.createElement("div",null,t&&Mt.a.createElement(Rn,zn({},p,{shown:n&&!l,onClose:this.handleClose})),n&&!t&&Mt.a.createElement(Tn,p),this.renderSMSCodeVerification())}}]),t}(Bt.Component),at.propTypes={isInModal:Dt.a.bool,onClose:Dt.a.func,shown:Dt.a.bool.isRequired},at.defaultProps={isInModal:!1},it),Zn=Xn,Kn=(n(1292),Zn),Gn=n(8),Jn=n(374),$n=n(1293),er=n.n($n),tr=n(228),nr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rr=Z,or=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ar="/oauth/account_callback",ir={qq:"/oauth/redirect/login/qqconn?next=",sina:"/oauth/redirect/login/sina?next=",wechat:"/oauth/redirect/login/wechat?next="},sr=(ct=st=function(e){function t(){var e,n,r,o;K(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=G(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={socialButtonExpanded:!1},r.accountCallback=function(e){var t=e.login,n=e.type;t?(Object(Ln.b)(r.clickedServiceName),r.handleLogSocialLoginSuccess(),location.reload()):r.props.onRegister({bySocial:!0,socialType:n})},r.handleBuildSocialAuthLink=function(e){r.clickedServiceName=e,r.handleLogSingleSocialButtonClick(e),window.NWEB={accountCallback:r.accountCallback},document.domain="zhihu.com";var t=ir[e];"sina"!==e?window.open(""+t+ar,"_blank","top=200,left=400,width=600,height=550,directories=no,menubar=no,toolbar=no"):location.href=""+t+ar+"&from="+encodeURIComponent(r.parseNextInfoFromUrl())},r.handleChangeSocialButtonState=function(){r.handleLogSocialLogin(),r.setState(function(e){return{socialButtonExpanded:!e.socialButtonExpanded}})},r.parseNextInfoFromUrl=function(){var e=location.href.split("next");return!e||e.length<=1?location.pathname:e[1].slice(1)},o=n,G(r,o)}return J(t,e),or(t,[{key:"componentWillUnmount",value:function(){window.NWEB&&(document.domain="www.zhihu.com",delete window.NWEB)}},{key:"handleLogSocialLogin",value:function(){wn.default.trackEvent(this,{action:"Click",element:"Button",element_name:"SNSSignIn"})}},{key:"handleLogSingleSocialButtonClick",value:function(e){S(this,"SignIn",{type:Sn[e]})}},{key:"handleLogSocialLoginSuccess",value:function(){C(this,"SignIn",this.clickedServiceName)}},{key:"render",value:function(){var e=this,t=this.state.socialButtonExpanded;return Mt.a.createElement("span",{className:"Login-socialLogin"},Mt.a.createElement(xt.default,{preset:"plain",onClick:this.handleChangeSocialButtonState,className:zt()("Login-socialButtonEntrance",{"Login-socialButtonEntrance--hidden":t})},"社交帐号登录"),Mt.a.createElement("span",{className:zt()("Login-socialButtonGroup",{"Login-socialButtonGroup--hidden":!t})},Mt.a.createElement(xt.default,{preset:"plain",className:"Login-socialButton",onClick:function(){return e.handleBuildSocialAuthLink("wechat")},disabled:!t},Mt.a.createElement(Yt.default,{name:"wechat",className:"Login-socialIcon",width:18,height:17})),Mt.a.createElement(xt.default,{preset:"plain",className:"Login-socialButton",onClick:function(){return e.handleBuildSocialAuthLink("sina")},disabled:!t},Mt.a.createElement(Yt.default,{name:"weibo",className:"Login-socialIcon",width:20,height:16})),Mt.a.createElement(xt.default,{preset:"plain",className:"Login-socialButton",onClick:function(){return e.handleBuildSocialAuthLink("qq")},disabled:!t},Mt.a.createElement(Yt.default,{name:"qq",className:"Login-socialIcon",width:17,height:19}))))}}]),t}(Bt.Component),st.propTypes={onRegister:Dt.a.func.isRequired},ct),cr=sr,ur=n(91),lr=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),pr=(ut=Object(Ft.connect)(ne,{getQrcodeLoginToken:Jn.c,checkQrcodeScanStatus:Jn.a,getReQesXUDID:Jn.d}))(lt=Object(Gn.withRouter)((ft=pt=function(e){function t(e){$(this,t);var n=ee(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.cancelCheckQrcodeScanStatus=function(){n.timer&&window.clearInterval(n.timer)},n.checkQrcodeScanStatus=function(e){var t=n.props.checkQrcodeScanStatus;n.timer=setInterval(function(){t({token:e})},2e3)},n.handleChangeStauts=function(e,t){n.setState({stauts:e}),"init"!==e||t||n.getToken()},n.handleChangeLoginType=function(){var e=n.props.onChangeType;n.cancelCheckQrcodeScanStatus(),e()},n.state={type:"password",stauts:"init",errorMessage:""},n}return te(t,e),lr(t,[{key:"componentDidMount",value:function(){this.getToken()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.qrcodeLoginToken,r=t.qrcodeLoginScanStatus,o=e.qrcodeLoginToken,a=e.qrcodeLoginScanStatus,i=e.qrcodeLoginError,s=e.qrcodeLoginReturnNewToken;""!==o&&n!==o?(this.cancelCheckQrcodeScanStatus(),"init"!==this.state.stauts&&this.handleChangeStauts("init",!0),this.checkQrcodeScanStatus(o)):r!==a?2!==a&&this.handleChangeStauts(1===a?"success":"init",s||1===r&&0===a):i&&i.code&&(this.cancelCheckQrcodeScanStatus(),40321===i.code&&this.setState({stauts:"error",errorMessage:i.message}))}},{key:"componentWillUnmount",value:function(){this.cancelCheckQrcodeScanStatus()}},{key:"getToken",value:function(){var e=this,t=this.props,n=t.getQrcodeLoginToken,r=t.getReQesXUDID,o=t.token;o&&o.xUDID||this.reQesXUDID?n():r().then(function(){e.reQesXUDID=!0,n()})}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.isShowPasswordLogin,o=t.qrcodeLoginToken,a=this.state,i=a.stauts,s=a.errorMessage;return"init"===i?Mt.a.createElement("div",{className:zt()("Qrcode-container",n)},Mt.a.createElement("div",{className:"Qrcode-content"},Mt.a.createElement("div",{className:"Qrcode-img"},o?Mt.a.createElement("img",{width:"150",height:"150",src:"https://account.zhihu.com/api/login/qrcode/"+o+"/image",alt:"二维码"}):Mt.a.createElement(ur.a,{count:3})),Mt.a.createElement("p",null,"打开",Mt.a.createElement("a",{href:"https://www.zhihu.com/app/",target:"_blank"}," 知乎 App")),Mt.a.createElement("p",null,"在「更多」页面右上角打开扫一扫")),!1!==r&&Mt.a.createElement("div",{className:"Qrcode-cutButton"},Mt.a.createElement("span",{onClick:function(){return e.handleChangeLoginType()}},"使用密码登录"))):"success"===i?Mt.a.createElement("div",{className:zt()("Qrcode-container",n)},Mt.a.createElement("div",{className:"Qrcode-content"},Mt.a.createElement("div",{className:"Qrcode-scanResultStaus"},Mt.a.createElement(Yt.default,{name:"success",fill:"#2db370",width:58,height:58})),Mt.a.createElement("p",{className:"Qrcode-scanResultTips"},"扫描成功"),Mt.a.createElement("p",null,"请在手机上「确认登录」")),Mt.a.createElement("div",{className:"Qrcode-cutButton"},Mt.a.createElement("span",{onClick:function(){return e.handleChangeStauts("init")}},"返回二维码"))):Mt.a.createElement("div",{className:zt()("Qrcode-container",n)},Mt.a.createElement("div",{className:"Qrcode-content Qrcode-failure"},Mt.a.createElement("div",null,Mt.a.createElement(Yt.default,{name:"failure",fill:"#ffaa00",width:58,height:58})),Mt.a.createElement("p",null,s)),!1!==r&&Mt.a.createElement("div",{className:"Qrcode-cutButton"},Mt.a.createElement("span",{onClick:function(){return e.handleChangeLoginType()}},"使用密码登录")))}}]),t}(Bt.Component),pt.propTypes={type:Dt.a.string,isShowPasswordLogin:Dt.a.bool,onChangeType:Dt.a.func,getQrcodeLoginToken:Dt.a.func,checkQrcodeScanStatus:Dt.a.func},pt.defaultProps={qrcodeLoginToken:"",qrcodeLoginScanStatus:""},lt=ft))||lt)||lt,fr=pr,hr=(n(389),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),dr=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),mr={username:null,password:null,captcha:null,digits:null},br=Mt.a.createElement("div",{className:"SignFlow-snackBar"},Mt.a.createElement("span",{className:"Login-accountBlockEmphasis"},"帐号已停用。"),Mt.a.createElement("span",null,"如有疑问，请发邮件至"),Mt.a.createElement("a",{className:"SignFlow-snackBarLink",href:"mailto:i@zhihu.com"}," i@zhihu.com "),Mt.a.createElement("span",null,"联系管理员")),yr=(ht=Object(Ft.connect)(se,{validateLogin:Jn.f,resetLoginValidateResult:Jn.e,validateSendDigits:Jn.g}),dt=Object(qt.a)(ce),ht(mt=Object(Gn.withRouter)(mt=dt((yt=bt=function(e){function t(e){oe(this,t);var n=ae(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));gt.call(n);var r=e.selectedCountry,o=e.username,a=e.password;return n.state={smsType:"text",smsBackUpName:"语音",smsBackUpDisplay:!0,reStartTime:-1,supportedCountriesShown:!1,captcha:"",selectedCountry:r,username:o,password:a,customErrorInputMap:hr({},mr),validationResult:{},smsInputInterceptTime:-1},n}return ie(t,e),dr(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.sendDigitsError,r=t.captchaValidationMessage,o=t.loginConfirmSucceeded,a=t.loginConfirmError,i=e.sendDigitsError,s=e.captchaValidationMessage,c=e.loginConfirmSucceeded,u=e.loginConfirmError,l=e.onShowExtraInfo;if(!n&&i||o!==c&&!1===c){var p=!n&&i?{smsInputInterceptTime:Date.now()}:{},f=this.parseServerError(e),h=f.captchaServerError;this.setState(hr({},p,{validationResult:{message:h,needsRefresh:!0,timestamp:Date.now()}})),this.handleLogSubmitValidateError(i||u),!u||!u.extra||a&&a.extra===u.extra||l(br)}else if(r!==s){var d=s?{smsInputInterceptTime:Date.now()}:{};this.setState(hr({validationResult:{message:s,needsRefresh:Boolean(s),timestamp:Date.now()}},d)),s&&this.handleLogSubmitValidateError(s)}else!o&&c&&(Object(Ln.b)(this.state.username),this.handleLogSubmitSuccess(),location.reload());(s||(n||i)&&null===u)&&this.handleCountDownEndEvent()}},{key:"componentWillUnmount",value:function(){this.props.resetLoginValidateResult()}},{key:"buildZAAccount",value:function(){var e=this.state,t=e.username,n=e.selectedCountry.code,r=X(t,n),o=r.value,a=r.isEmail;return{email:a&&o?o:null,phone:a||!o?null:o,type:"Zhihu"}}},{key:"handleLogSubmitSuccess",value:function(){C(this,"SignIn",this.buildZAAccount(),"digits"===this.props.type?"SMSSignIn":null)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onSwitch,r=t.type,o=this.state,a=o.supportedCountriesShown,i=o.selectedCountry,s=o.username,c=o.password,u=o.validationResult,l=o.smsType,p=o.smsBackUpName,f=o.smsBackUpDisplay,h=o.customErrorInputMap.username,d=o.smsInputInterceptTime,m=o.reStartTime,b=this.parseServerError(),y=b.usernameServerError,g=b.passwordServerError,v=b.digitsServerError,w=Mt.a.createElement(un,{className:"SignFlow-captchaContainer",canCaptchaShown:this.checkAllInputFilled(),type:"digits"===r?"digitsLogin":"login",onUpdateInput:function(t){return e.handleChange("captcha",t)},validationResult:u});return"qrcode"===r?Mt.a.createElement(fr,{className:"SignInQrcode",onChangeType:function(){return e.handleChangeType("password")}}):Mt.a.createElement(ln.b,{className:"SignFlow",onSubmit:this.handleSubmit,onPreSubmit:this.handleLogSubmit,onInvalid:this.handleLogSubmitValidateError},Mt.a.createElement(pn.a,{type:"digits"===r||a?"digits":"password",supportedCountriesShown:a,onChange:function(t){return e.handleChange("username",t)},onSelect:function(t){return e.handleChange("selectedCountry",t)},defaultSelectedCountry:i,manualValidateError:y||h,defaultValue:s}),"digits"===r&&w,"digits"===r&&Mt.a.createElement(Vn,{countDownEvent:function(){return e.handleSendDigits()},countDownEndEvent:this.handleCountDownEndEvent,interceptTime:d,manualValidateError:v,smsType:l,reStartTime:m}),"password"===r&&Mt.a.createElement(mn,{onChange:function(t){return e.handleChange("password",t)},manualValidateError:g,defaultValue:c}),"password"===r&&w,Mt.a.createElement("div",{className:"Login-options"},Mt.a.createElement(xt.default,{preset:"plain",className:"Login-switchType",onClick:function(){return e.handleChangeType("digits"===r?"password":"digits")}},"digits"===r?"密码登录（手机号或邮箱）":"手机验证码登录"),Mt.a.createElement(xt.default,{preset:"plain",className:"Login-cannotLogin",onClick:"digits"===r?this.handleChangeSmsType:this.handleResetPassword},"digits"===r?f&&"接收"+p+"验证码":"忘记密码？")),Mt.a.createElement(xt.default,{type:"submit",className:"SignFlow-submitButton",preset:"primary",color:"blue"},"登录"),Mt.a.createElement("div",{className:"Login-footer"},Mt.a.createElement("span",{className:"Login-qrcode"},Mt.a.createElement(xt.default,{preset:"plain",onClick:function(){return e.handleChangeType("qrcode")}},"二维码登录")),Mt.a.createElement("span",{className:"Login-footerSeparate Login-qrcodeSeparate"}," · "),Mt.a.createElement("span",{className:"Login-aboardPhone"},Mt.a.createElement(xt.default,{preset:"plain",onClick:this.handleSupportedCountriesShown},a?"邮箱帐号登录":"海外手机登录")),Mt.a.createElement("span",{className:"Login-footerSeparate"}," · "),Mt.a.createElement(cr,{onRegister:n})))}}]),t}(Bt.Component),bt.propTypes={validateLogin:Dt.a.func,resetLoginValidateResult:Dt.a.func,validateSendDigits:Dt.a.func,loginConfirmSucceeded:Dt.a.bool,loginConfirmError:Dt.a.object,sendDigitsError:Dt.a.object,captchaValidationMessage:Dt.a.string,captchaNeeded:Dt.a.bool,onSwitch:Dt.a.func,onShowExtraInfo:Dt.a.func,selectedCountry:Dt.a.object,username:Dt.a.string,password:Dt.a.string,type:Dt.a.oneOf(["password","digits","qrcode"]),onChangeType:Dt.a.func},bt.defaultProps={selectedCountry:{name:"中国",code:"+86"},username:"",password:""},gt=function(){var e=this;this.checkAllInputFilled=function(){if(e.allInputFilled)return e.allInputFilled;var t=e.props.type,n=e.state,r=n.username,o=n.password;return e.allInputFilled="digits"===t?Boolean(r):Boolean(r)&&Boolean(o),e.allInputFilled},this.handleChange=function(t,n){e.setState(re({},t,n))},this.handleChangeType=function(t){var n=e.props,r=n.type;(0,n.onChangeType)(t),"qrcode"!==t&&"password"!==t||wn.default.trackEvent(e,{action:"Click",name:"qrcode"===t?"使用二维码登录":"使用密码登录"},{account:{type:"Zhihu"}}),"qrcode"!==t&&(e.setState(function(e){var t=e.username;return{username:"password"===r&&Q(t)?"":t,smsBackUpDisplay:!0}}),wn.default.trackEvent(e,{action:"Switch",element:"Button"},{account:{type:"Zhihu"}}))},this.handleChangeSmsType=function(){e.setState(function(e){var t=e.smsType;return{smsType:"text"===t?"voice":"text",smsBackUpName:"text"===t?"短信":"语音",reStartTime:Date.now()}})},this.handleCountDownEndEvent=function(){e.setState({smsBackUpDisplay:!0})},this.handleSendDigits=function(){e.setState({customErrorInputMap:hr({},mr),validationResult:{needsRefresh:!1,timestamp:Date.now()}},function(){var t=e.props,n=t.validateSendDigits,r=t.captchaNeeded,o=t.resetLoginValidateResult,a=e.state,i=a.username,s=a.selectedCountry.code,c=a.captcha,u=a.customErrorInputMap,l=a.validationResult,p=a.smsType;if(o(),i&&(!r||c)){return n({username:X(i,s).value,captcha:c,smsType:p}),void e.setState({smsBackUpDisplay:!1})}var f=r&&!c?{message:"请输入验证码",needsRefresh:!1,timestamp:Date.now()}:hr({},l);e.setState({customErrorInputMap:hr({},u,{username:i?"":"请输入手机号"}),smsInputInterceptTime:Date.now(),validationResult:f}),e.handleLogSubmitValidateError({username:i?"":"请输入手机号",captcha:r&&!c?"请输入验证码":""})})},this.handleSupportedCountriesShown=function(){e.setState(function(e){return{supportedCountriesShown:!e.supportedCountriesShown}})},this.handleSubmit=function(t){var n=e.props,r=n.validateLogin,o=n.type,a=e.state,i=a.selectedCountry,s=a.captcha,c=hr({},t,{username:X(t.username,i.code).value,captcha:s});r(rr(o,c))},this.parseServerError=function(t){var n=t||e.props,r=n.loginConfirmError,o=n.sendDigitsError,a=r||{},i=a.username,s=a.password,c=a.digits,u=a.captcha,l=o||{},p=l.username;return{usernameServerError:i||p,passwordServerError:s,digitsServerError:c,captchaServerError:u}},this.handleResetPassword=function(){var t=e.props.onClose;wn.default.trackEvent(e,{action:"Click",element:"Button",element_name:"ResetPassword"}),t(),window.open("/account/password_reset","_blank")},this.handleLogSubmit=function(){S(e,"SignIn",e.buildZAAccount(),"digits"===e.props.type?"SMSSignIn":null)},this.handleLogSubmitValidateError=function(t){O(e,"SignIn",e.buildZAAccount(),t,"digits"===e.props.type?"SMSSignIn":null)}},mt=yt))||mt)||mt)||mt),gr=yr,vr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wr=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Er=(wt=vt=function(e){function t(){var e,n,r,o;le(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=pe(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={modalExtraInfo:null},r.handleModalExtraInfo=function(e){r.setState({modalExtraInfo:e})},o=n,pe(r,o)}return fe(t,e),wr(t,[{key:"render",value:function(){var e=this.props,t=e.shown,n=ue(e,["shown"]),r=this.state.modalExtraInfo;return Mt.a.createElement(Pn.default,{onClose:n.onClose,footer:r,maskClosable:!1,spread:!0},t&&Mt.a.createElement("div",null,Mt.a.createElement(Nn,{title:"登录知乎"}),Mt.a.createElement(gr,vr({onShowExtraInfo:this.handleModalExtraInfo},n))))}}]),t}(Bt.Component),vt.propTypes={onClose:Dt.a.func.isRequired,shown:Dt.a.bool},vt.defaultProps={shown:!1},wt),Sr=Er,Cr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Or=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),kr=(St=Et=function(e){function t(){var e,n,r,o;de(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=me(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={type:"password"},r.handleChangeType=function(e){r.setState({type:e||"password"})},o=n,me(r,o)}return be(t,e),Or(t,[{key:"render",value:function(){var e=this.props,t=e.isInModal,n=e.shown,r=e.onClose,o=he(e,["isInModal","shown","onClose"]),a=Cr({type:this.state.type,onChangeType:this.handleChangeType},o);return Mt.a.createElement("div",null,t&&Mt.a.createElement(Sr,Cr({shown:n,onClose:r},a)),n&&!t&&Mt.a.createElement(gr,a))}}]),t}(Bt.Component),Et.propTypes={isInModal:Dt.a.bool,onClose:Dt.a.func,onSwitch:Dt.a.func,shown:Dt.a.bool},Et.defautProps={isInModal:!1},St),Tr=kr,Pr=(n(1294),Tr),Nr=n(390),jr=n(48),_r=(n(1135),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()),Ar=(Ct=Object(Ft.connect)(Ee,{getUnlockTicketAndDigits:Nr.c,activeUserByEmail:Nr.a,validateAndActiveUserByDigits:Nr.d,activeUser:jr.a}))((Tt=kt=function(e){function t(e){ge(this,t);var n=ve(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkUserAccountType=function(e){return e.email?"email":"noInfo"},n.handleChange=function(e,t){n.setState(ye({},e,t))},n.handleChangeSmsType=function(){n.setState(function(e){var t=e.smsType;return{smsType:"text"===t?"voice":"text",smsBackUpName:"text"===t?"短信":"语音",reStartTime:Date.now()}})},n.handleCountDownEndEvent=function(){n.setState({smsBackUpDisplay:!0})},n.handleSendDigits=function(){var e=n.props.getUnlockTicketAndDigits,t=n.state,r=t.selectedCountry.code,o=t.phoneNo,a=t.smsType;n.setState({manualError:null},function(){if(o)return e({newPhoneNo:""+r+o,smsType:a}),void n.setState({smsBackUpDisplay:!1});n.setState({manualError:"请输入手机号",smsInputInterceptTime:Date.now()})})},n.handleSubmit=function(e){var t=n.props,r=t.email,o=t.activeUserByEmail,a=t.validateAndActiveUserByDigits,i=t.onClose,s=n.state,c=s.accountType,u=s.selectedCountry.code,l=e.username,p=e.digits;"email"===c?(o({email:r}),"function"==typeof i&&i()):a({newPhoneNo:""+u+l,digits:p})},n.parseServerError=function(){var e=n.props,t=e.activeConfirmError,r=e.sendDigitsError,o=t||{},a=o.username,i=o.digits,s=r||{},c=s.username;return{usernameServerError:a||c,digitsServerError:i}},n.renderAccountInfo=function(){var e=n.props.email,t=n.state,r=t.accountType,o=t.manualError,a=n.parseServerError(),i=a.usernameServerError;return"noInfo"!==r?Mt.a.createElement("div",{className:"SignFlowActive-account"},e,"email"===r&&Mt.a.createElement("a",{target:"_blank",href:"/settings/account",className:"SignFlowActive-editEmail"},"修改邮箱")):Mt.a.createElement(pn.a,{type:"digits",supportedCountriesShown:!0,manualValidateError:i||o,onSelect:function(e){return n.handleChange("selectedCountry",e)},onChange:function(e){return n.handleChange("phoneNo",e)}})},n.state={accountType:n.checkUserAccountType(e),selectedCountry:{code:"+86",name:"中国"},phoneNo:null,smsInputInterceptTime:-1,manualError:null,smsType:"text",smsBackUpName:"语音",smsBackUpDisplay:!0,reStartTime:-1},n}return we(t,e),_r(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.sendDigitsError,r=t.onClose,o=t.activeUser,a=e.activeConfirmSucceeded,i=e.sendDigitsError;a?(r(),o()):!n&&i&&(this.setState({smsInputInterceptTime:Date.now()}),this.handleCountDownEndEvent())}},{key:"render",value:function(){var e=this.state,t=e.accountType,n=e.smsInputInterceptTime,r=e.smsType,o=e.smsBackUpName,a=e.smsBackUpDisplay,i=e.reStartTime,s=this.parseServerError(),c=s.digitsServerError;return Mt.a.createElement(ln.b,{className:"SignFlowActive SignFlow",onSubmit:this.handleSubmit},this.renderAccountInfo(),"email"!==t&&[Mt.a.createElement(Vn,{key:"sms-input",manualValidateError:c,interceptTime:n,countDownEvent:this.handleSendDigits,countDownEndEvent:this.handleCountDownEndEvent,smsType:r,reStartTime:i}),a&&Mt.a.createElement("div",{key:"smsBackUp-button",className:"SignFlowActive-options"},Mt.a.createElement(xt.default,{preset:"plain",className:"SignFlowActive-cutSmsType",onClick:this.handleChangeSmsType},"接收"+o+"验证码"))],Mt.a.createElement(xt.default,{className:"email"===t?"SignFlowActive-sendEmail":"SignFlowActive-sendDigits",preset:"primary",color:"blue",type:"submit"},"email"===t?"发送激活邮件":"激活"))}}]),t}(Bt.Component),kt.propTypes={email:Dt.a.string,sendDigitsError:Dt.a.object,getUnlockTicketAndDigits:Dt.a.func,activeUserByEmail:Dt.a.func,validateAndActiveUserByEmail:Dt.a.func,activeConfirmSucceeded:Dt.a.bool,activeConfirmError:Dt.a.object,onClose:Dt.a.func},Ot=Tt))||Ot,Rr=Ar,Ir=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dr=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Br=(Nt=Pt=function(e){function t(){var e,n,r,o;Ce(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=Oe(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={snackbar:null},r.handleSetSnackbar=function(e){return r.setState({snackbar:e})},o=n,Oe(r,o)}return ke(t,e),Dr(t,[{key:"render",value:function(){var e=this.props,t=e.shown,n=e.onClose,r=Se(e,["shown","onClose"]);return Mt.a.createElement(Pn.default,{title:"激活帐号",subtitle:"为了正常使用知乎的提问、回答、评论和编辑功能，请绑定你的手机",onClose:n,maskClosable:!1,footer:this.state.snackbar},t&&Mt.a.createElement(Rr,Ir({onClose:n,onSetSnackbar:this.handleSetSnackbar},r)))}}]),t}(Bt.Component),Pt.propTypes={shown:Dt.a.bool.isRequired,onClose:Dt.a.func.isRequired},Nt),Mr=Br,Fr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xr=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Vr=(_t=jt=function(e){function t(){return Pe(this,t),Ne(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return je(t,e),xr(t,[{key:"render",value:function(){var e=this.props,t=e.isInModal,n=e.shown,r=e.onClose,o=Te(e,["isInModal","shown","onClose"]);return Mt.a.createElement("div",null,t?Mt.a.createElement(Mr,Fr({onClose:r,shown:n},o)):Mt.a.createElement(Rr,o))}}]),t}(Bt.Component),jt.propTypes={isInModal:Dt.a.bool,shown:Dt.a.bool,onClose:Dt.a.func},jt.defaultProps={isInModal:!1},_t),Lr=Vr,Ur=(n(391),Lr),qr=(n(1295),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Hr=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Wr=(Rt=At=function(e){function t(){return Ae(this,t),Re(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Ie(t,e),Hr(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=_e(e,["type"]),r=qr({isInModal:!0},n);return Mt.a.createElement("div",null,Mt.a.createElement(Kn,qr({},r,{shown:"register"===t})),Mt.a.createElement(Pr,qr({},r,{shown:"login"===t})),Mt.a.createElement(Ur,qr({},r,{shown:"active"===t})))}}]),t}(Bt.Component),At.propTypes={type:Dt.a.oneOf(["register","login","initial","active"]),onClose:Dt.a.func.isRequired,onSwitch:Dt.a.func},Rt);t.default=Wr},1129:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return O});var c,u,l,p,f=n(1),h=n.n(f),d=n(0),m=n.n(d),b=n(2),y=n.n(b),g=n(41),v=n(36),w=n(1130),E=n(1285),S=(n.n(E),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),C=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),O=(c=Object(w.a)())((p=l=function(e){function t(){var e,n,r,o;a(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.handleErrorHide=function(){r.getValidationMessage()&&r.setState({errorMaskShown:!1},function(){r.clearValidations({errorMaskShown:!0},function(){return r.inputEl.focus()})})},r.handleKeyUp=function(e){8!==e.keyCode&&9!==e.keyCode||r.clearValidations()},r.handleChange=function(e){var t=e.target.value,n=r.props.onChange;r.setValue(t),"function"==typeof n&&n(t)},o=n,i(r,o)}return s(t,e),C(t,[{key:"componentDidMount",value:function(){var e=this.props.defaultValue;e&&this.setValue(e),this.state={errorMaskShown:!0}}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.manualValidateError,r=t.type,o=t.smsType,a=e.manualValidateError,i=e.type,s=e.defaultValue,c=e.smsType;!n&&a||"string"==typeof n&&n!==a?this.addManualValidation(a):n&&!a&&this.clearValidations({errorMaskShown:!0}),r===i&&o===c||(this.setValue(s),this.clearValidations({errorMaskShown:!0}))}},{key:"render",value:function(){var e,t=this,n=Object(g.omit)(this.props,"validations","defaultValue","onChange","smsType","manualValidateError"),a=n.className,i=n.inputClassName,s=n.errorMessageClassName,c=o(n,["className","inputClassName","errorMessageClassName"]),u=this.state||{},l=u.errorMaskShown,p=this.getValue(),f=this.getValidationMessage();return m.a.createElement("div",{className:y()("SignFlowInput",a)},m.a.createElement(v.default,S({onRef:function(e){t.inputEl=e},value:p,onChange:this.handleChange,onKeyUp:this.handleKeyUp,onClick:this.handleErrorHide,onBlur:function(){return t.validate()},className:i},c)),m.a.createElement("div",{className:y()("SignFlowInput-errorMask",this.getValidationClassName(),(e={},r(e,s,f),r(e,"SignFlowInput-requiredErrorMask",!p),r(e,"SignFlowInput-errorMask--hidden",!f||!l),e)),onClick:this.handleErrorHide},f))}}]),t}(d.Component),l.propTypes={inputClassName:h.a.string,errorMessageClassName:h.a.string,manualValidateError:h.a.node},u=p))||u},1130:function(e,t,n){"use strict";function r(e,t){return t?e.trim():e}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e){function t(e){for(var t=a[e],n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return"function"==typeof t?t.apply(void 0,r):void 0}var n=e.contextTypes,r=e.defaultProps,a=Object.assign({},e.prototype);Object.assign(e.prototype,{componentWillMount:function(){var e=this.context.form;e&&(e.attachToForm(this),this.setState({_value:"",_validations:[]}));for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.apply(void 0,["componentWillMount"].concat(r))},componentWillUnmount:function(){var e=this.context.form;e&&e.detachFromForm(this);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.apply(void 0,["componentWillUnmount"].concat(r))},getValue:function(){var e=this.state||{},t=e._value;return null==t?"":t},setValue:function(e,t){this.setState({_value:e},function(){"function"==typeof t&&t()})},getValidationMessage:function(){var e=this.getValidationMessages();return e&&e[0]},getValidationClassName:function(){var e=this.state||{},t=e._validations;return t&&t[0]&&t[0].className},getValidationMessages:function(){var e=this.state||{},t=e._validations;return t&&t.map(function(e){return e.message})},setValidations:function(e){var t=this;this.setState({_validations:e},function(){return t.forceUpdate()})},clearValidations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=this.state||{},r=n._validations;r&&r.length>0&&this.setState(C({},e,{_validations:[]}),t)},addValidation:function(e){this.setState(function(t){var n=t._validations;return{_validations:[e].concat(o(n||[]))}})},addManualValidation:function(e){this.addValidation({type:"manual",message:e})},validate:function(){this.context.form.validate(this)}}),Object.assign(e,{contextTypes:C({},n,{form:d.a.object}),defaultProps:C({},r,{validations:[]})})}function i(){return function(e){return a(e)}}function s(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=n(1),d=n.n(h),m=n(0),b=n.n(m),y=n(14),g=n(3),v=n(41),w={useTrim:!0},E={required:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";arguments[1];return""!==r(e,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:w).useTrim)},maxLength:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];return r(e,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:w).useTrim).length<=t},minLength:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];return r(e,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:w).useTrim).length>=t},pattern:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w,o=n.useTrim;return t.test(r(e,o))}},S=E,C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.d(t,"b",function(){return _}),n.d(t,"a",function(){return i});var O,k,T,P,N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_=(O=Object(g.connect)(function(e){return{isWechat:e.env.userAgent.Wechat}}))((P=T=function(e){function t(){var e,n,r,o;l(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={isValid:!0},r.inputs=[],r.attachToForm=function(e){var t=e.props.name;if(!t||r.inputs.includes(t))throw new Error("form input must specify a unqie name, but current is "+t);r.inputs.push(e)},r.detachFromForm=function(e){var t=r.inputs.indexOf(e);-1!==t&&(r.inputs=[].concat(u(r.inputs.slice(0,t)),u(r.inputs.slice(t+1))))},r.validate=function(e){var t=e.state._value,n=e.props.validations,r=[],o=[];return n?(!Array.isArray(n)&&n.type&&(n=[n]),n.forEach(function(e){var n=e.type,a=e.value,i=e.options,s=S[n];if(!s)throw new Error("no "+n+" rules, please define it at Form.validateRules");var c=s(t,a,i);"function"==typeof c.then?o=[].concat(u(o),[c.then(function(){},function(){r.push(e)})]):c||(r=[].concat(u(r),[e]))}),Promise.all(o).then(function(){return e.setValidations(r),r})):r},r.handleSubmit=function(e){e.preventDefault();var t=r.props,n=t.onPreSubmit,o=t.onSubmit,a=t.isWechat;if(n(),a)return void new Promise(function(e){var t=r.inputs.find(function(e){return"username"===e.props.name});t&&!t.state._value&&Object(y.findDOMNode)(t.inputEl).value&&t.handleChange({target:{value:Object(y.findDOMNode)(t.inputEl).value}});var n=r.inputs.find(function(e){return"password"===e.props.name});n&&!n.state._value&&Object(y.findDOMNode)(t.inputEl).value&&n.handleChange({target:{value:Object(y.findDOMNode)(n.inputEl).value}}),e()}).then(function(){r.validateAll().then(function(e){if(e){var t=r.inputs.reduce(function(e,t){return N({},e,c({},t.props.name,t.state._value))},{});o(t)}})});r.validateAll().then(function(e){if(e){var t=r.inputs.reduce(function(e,t){return N({},e,c({},t.props.name,t.state._value))},{});o(t)}})},o=n,p(r,o)}return f(t,e),j(t,[{key:"getChildContext",value:function(){return{form:{attachToForm:this.attachToForm,detachFromForm:this.detachFromForm,getValue:this.getValue,setValue:this.setValue,validate:this.validate}}}},{key:"componentDidMount",value:function(){}},{key:"validateAll",value:function(){var e=this,t=this.props,n=t.onValid,r=t.onInvalid,o=[],a=[];return this.inputs.forEach(function(t){var n=e.validate(t);n&&"function"==typeof n.then?a=[].concat(u(a),[n.then(function(e){o=[].concat(u(o),u(e))})]):n&&(o=[].concat(u(o),u(n)))}),Promise.all(a).then(function(){var t=0===o.length;return e.setState({isValid:t},function(){t?n():r(o.map(function(e){return e.message}))}),t})}},{key:"render",value:function(){var e=Object(v.omit)(this.props,"onValid","onInvalid","onSubmit","onPreSubmit","isWechat","dispatch"),t=e.children,n=e.onRef,r=s(e,["children","onRef"]);return b.a.createElement("form",N({noValidate:!0,onSubmit:this.handleSubmit,ref:n},r),t)}}]),t}(m.Component),T.childContextTypes={form:d.a.object},T.propTypes={onValid:d.a.func,onInvalid:d.a.func,onSubmit:d.a.func,onPreSubmit:d.a.func},T.validateRules=S,T.defaultProps={onValid:function(){},onInvalid:function(){},onSubmit:function(){},onPreSubmit:function(){}},k=P))||k},1131:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{supportedCountries:e.sms.supportedCountries}}var c,u,l,p,f=n(1),h=n.n(f),d=n(0),m=n.n(d),b=n(3),y=(n.n(b),n(55)),g=n(41),v=n(231),w=n(1129),E=n(1286),S=(n.n(E),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),C=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),O=(c=Object(b.connect)(s,{getSupportedCountries:v.b}))((p=l=function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.state={selectedCountry:null},r.handleSelect=function(e,t){var n=r.props,o=n.supportedCountries,a=n.onSelect,i=o[t];r.setState({selectedCountry:i}),a(i)},i=n,a(r,i)}return i(t,e),C(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.supportedCountries,n=e.getSupportedCountries;t&&t.length||n()}},{key:"render",value:function(){var e=Object(g.omit)(this.props,"getSupportedCountries","onSelect"),n=e.supportedCountries,o=e.onChange,a=e.defaultPhoneNo,i=e.type,s=e.defaultSelectedCountry,c=e.supportedCountriesShown,u=e.placeholderPrefix,l=void 0===u?"":u,p=r(e,["supportedCountries","onChange","defaultPhoneNo","type","defaultSelectedCountry","supportedCountriesShown","placeholderPrefix"]),f=this.state.selectedCountry,h=f||s,d=h.name,b=h.code;return m.a.createElement("div",{className:"SignFlow-account"},m.a.createElement("div",{className:"SignFlow-supportedCountriesSelectContainer"},Boolean(n)&&Boolean(n.length)&&c&&m.a.createElement(y.default,{plain:!0,text:d+" "+b,onChange:this.handleSelect,className:"SignFlow-supportedCountriesSelect",targetClassName:"SignFlow-supportedCountriesList"},n.map(function(e,t){var n=e.name,r=e.code;return m.a.createElement(y.Option,{key:t,value:n+" "+r})}))),c&&m.a.createElement("span",{className:"SignFlow-accountSeperator"}," "),m.a.createElement(w.a,S({className:"SignFlow-accountInputContainer",name:"register"===i?"phoneNo":"username",inputClassName:"SignFlow-accountInput",placeholder:t.getPlaceholder(i,l),onChange:o,defaultValue:a,validations:[{type:"required",message:t.getPlaceholder(i,"请输入")}],type:"digits"===i||"register"===i?"tel":"text"},p)))}}]),t}(d.Component),l.propTypes={defaultPhoneNo:h.a.string,defaultSelectedCountry:h.a.object,supportedCountries:h.a.array,onSelect:h.a.func,onChange:h.a.func,getSupportedCountries:h.a.func,type:h.a.oneOf(["register","digits","password"]).isRequired,supportedCountriesShown:h.a.bool,placeholderPrefix:h.a.string},l.defaultProps={defaultPhoneNo:"",defaultSelectedCountry:{name:"中国",code:"+86"},supportedCountriesShown:!0},l.getPlaceholder=function(e,t){return t+("digits"===e||"register"===e?"手机号":"手机号或邮箱")},u=p))||u;t.a=O},1132:function(e,t){},1133:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,c,u=n(1),l=n.n(u),p=n(0),f=n.n(p),h=n(2),d=n.n(h),m=n(4),b=n(41),y=n(1290),g=(n.n(y),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),w=(c=s=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clearTimer=function(){n.timer&&window.clearInterval(n.timer)},n.handleClick=function(e){n.state.isCounting||n.startTiming(e)},n.state={countDownTime:e.countDownTime,isCounting:!1},n.isInitialState=!0,n}return i(t,e),v(t,[{key:"componentDidMount",value:function(){this.props.startAtOnce&&this.startTiming()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.interceptTime,r=t.reStartTime,o=e.interceptTime,a=e.reStartTime;n!==o&&this.resetTiming(),r!==a&&(this.resetTiming(),this.startTiming())}},{key:"componentWillUnmount",value:function(){this.clearTimer()}},{key:"resetTiming",value:function(){this.clearTimer(),this.setState({countDownTime:this.props.countDownTime,isCounting:!1})}},{key:"startTiming",value:function(e){var t=this,n=this.props,r=n.event,o=n.countDownEndEvent;"function"==typeof r&&r(e),this.isInitialState=!1,this.setState({isCounting:!0}),this.timer=setInterval(function(){var e=t.state.countDownTime;e<=0?(o&&o(),t.resetTiming()):t.setState({countDownTime:e-1})},1e3)}},{key:"renderText",value:function(){var e=this.props,t=e.initialText,n=e.resetText,r=e.countingText,o=this.state,a=o.countDownTime;return o.isCounting?r({count:a}):this.isInitialState?t:n||t}},{key:"render",value:function(){var e=Object(b.omit)(this.props,"initialText","resetText","countingText","startAtOnce","countDownTime","event","interceptTime","countDownEndEvent","reStartTime"),t=e.className,n=e.disabled,o=r(e,["className","disabled"]),a=this.state.isCounting;return f.a.createElement(m.default,g({className:d()("CountingDownButton",t,{"is-counting":a})},o,{onClick:this.handleClick,disabled:n||a}),this.renderText())}}]),t}(p.Component),s.propTypes={countDownTime:l.a.number,startAtOnce:l.a.bool,initialText:l.a.string.isRequired,resetText:l.a.string,countingText:l.a.func.isRequired,event:l.a.func,countDownEndEvent:l.a.func,interceptTime:l.a.number,reStartTime:l.a.number},s.defaultProps={countDownTime:60,startAtOnce:!1,interceptTime:-1,reStartTime:-1},c);t.a=w},1134:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var a=r[r.length-1]||{};return n.reduce(function(t,n,o){return t.concat(Number.isInteger(n)&&r[n]||a[n],e[o+1])},[e[0]]).join("")}}t.a=r},1135:function(e,t){},1136:function(e,t){},1285:function(e,t){},1286:function(e,t){},1287:function(e,t){},1288:function(e,t){},1289:function(e,t){},1290:function(e,t){},1291:function(e,t){},1292:function(e,t){},1293:function(e,t,n){"use strict";var r;!function(o){function a(e,t,n){var r,o,a,i,s,c,u,l,y,g=0,v=[],w=0,E=!1,S=[],C=[],O=!1,k=!1;if(n=n||{},r=n.encoding||"UTF8",y=n.numRounds||1,a=b(t,r),y!==parseInt(y,10)||1>y)throw Error("numRounds must a integer >= 1");if("SHA-1"===e)s=512,c=q,u=H,i=160,l=function(e){return e.slice()};else if(0===e.lastIndexOf("SHA-",0))if(c=function(t,n){return W(t,n,e)},u=function(t,n,r,o){var a,i;if("SHA-224"===e||"SHA-256"===e)a=15+(n+65>>>9<<4),i=16;else{if("SHA-384"!==e&&"SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");a=31+(n+129>>>10<<5),i=32}for(;t.length<=a;)t.push(0);for(t[n>>>5]|=128<<24-n%32,n+=r,t[a]=4294967295&n,t[a-1]=n/4294967296|0,r=t.length,n=0;n<r;n+=i)o=W(t.slice(n,n+i),o,e);if("SHA-224"===e)t=[o[0],o[1],o[2],o[3],o[4],o[5],o[6]];else if("SHA-256"===e)t=o;else if("SHA-384"===e)t=[o[0].a,o[0].b,o[1].a,o[1].b,o[2].a,o[2].b,o[3].a,o[3].b,o[4].a,o[4].b,o[5].a,o[5].b];else{if("SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");t=[o[0].a,o[0].b,o[1].a,o[1].b,o[2].a,o[2].b,o[3].a,o[3].b,o[4].a,o[4].b,o[5].a,o[5].b,o[6].a,o[6].b,o[7].a,o[7].b]}return t},l=function(e){return e.slice()},"SHA-224"===e)s=512,i=224;else if("SHA-256"===e)s=512,i=256;else if("SHA-384"===e)s=1024,i=384;else{if("SHA-512"!==e)throw Error("Chosen SHA variant is not supported");s=1024,i=512}else{if(0!==e.lastIndexOf("SHA3-",0)&&0!==e.lastIndexOf("SHAKE",0))throw Error("Chosen SHA variant is not supported");var T=6;if(c=z,l=function(e){var t,n=[];for(t=0;5>t;t+=1)n[t]=e[t].slice();return n},"SHA3-224"===e)s=1152,i=224;else if("SHA3-256"===e)s=1088,i=256;else if("SHA3-384"===e)s=832,i=384;else if("SHA3-512"===e)s=576,i=512;else if("SHAKE128"===e)s=1344,i=-1,T=31,k=!0;else{if("SHAKE256"!==e)throw Error("Chosen SHA variant is not supported");s=1088,i=-1,T=31,k=!0}u=function(e,t,n,r,o){n=s;var a,i=T,c=[],u=n>>>5,l=0,p=t>>>5;for(a=0;a<p&&t>=n;a+=u)r=z(e.slice(a,a+u),r),t-=n;for(e=e.slice(a),t%=n;e.length<u;)e.push(0);for(a=t>>>3,e[a>>2]^=i<<24-a%4*8,e[u-1]^=128,r=z(e,r);32*c.length<o&&(e=r[l%5][l/5|0],c.push((255&e.b)<<24|(65280&e.b)<<8|(16711680&e.b)>>8|e.b>>>24),!(32*c.length>=o));)c.push((255&e.a)<<24|(65280&e.a)<<8|(16711680&e.a)>>8|e.a>>>24),0==64*(l+=1)%n&&z(null,r);return c}}o=U(e),this.setHMACKey=function(t,n,a){var l;if(!0===E)throw Error("HMAC key already set");if(!0===O)throw Error("Cannot set HMAC key after calling update");if(!0===k)throw Error("SHAKE is not supported for HMAC");if(r=(a||{}).encoding||"UTF8",n=b(n,r)(t),t=n.binLen,n=n.value,l=s>>>3,a=l/4-1,l<t/8){for(n=u(n,t,0,U(e),i);n.length<=a;)n.push(0);n[a]&=4294967040}else if(l>t/8){for(;n.length<=a;)n.push(0);n[a]&=4294967040}for(t=0;t<=a;t+=1)S[t]=909522486^n[t],C[t]=1549556828^n[t];o=c(S,o),g=s,E=!0},this.update=function(e){var t,n,r,i=0,u=s>>>5;for(t=a(e,v,w),e=t.binLen,n=t.value,t=e>>>5,r=0;r<t;r+=u)i+s<=e&&(o=c(n.slice(r,r+u),o),i+=s);g+=i,v=n.slice(i>>>5),w=e%s,O=!0},this.getHash=function(t,n){var r,a,s,c;if(!0===E)throw Error("Cannot call getHash after setting HMAC key");if(s=m(n),!0===k){if(-1===s.shakeLen)throw Error("shakeLen must be specified in options");i=s.shakeLen}switch(t){case"HEX":r=function(e){return p(e,i,s)};break;case"B64":r=function(e){return f(e,i,s)};break;case"BYTES":r=function(e){return h(e,i)};break;case"ARRAYBUFFER":try{a=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}r=function(e){return d(e,i)};break;default:throw Error("format must be HEX, B64, BYTES, or ARRAYBUFFER")}for(c=u(v.slice(),w,g,l(o),i),a=1;a<y;a+=1)!0===k&&0!=i%32&&(c[c.length-1]&=4294967040<<24-i%32),c=u(c,i,0,U(e),i);return r(c)},this.getHMAC=function(t,n){var r,a,b,y;if(!1===E)throw Error("Cannot call getHMAC without first setting HMAC key");switch(b=m(n),t){case"HEX":r=function(e){return p(e,i,b)};break;case"B64":r=function(e){return f(e,i,b)};break;case"BYTES":r=function(e){return h(e,i)};break;case"ARRAYBUFFER":try{r=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}r=function(e){return d(e,i)};break;default:throw Error("outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER")}return a=u(v.slice(),w,g,l(o),i),y=c(C,U(e)),y=u(a,i,s,y,i),r(y)}}function i(e,t){this.a=e,this.b=t}function s(e,t,n){var r,o,a,i,s,c=e.length;if(t=t||[0],n=n||0,s=n>>>3,0!=c%2)throw Error("String of HEX type must be in byte increments");for(r=0;r<c;r+=2){if(o=parseInt(e.substr(r,2),16),isNaN(o))throw Error("String of HEX type contains invalid characters");for(i=(r>>>1)+s,a=i>>>2;t.length<=a;)t.push(0);t[a]|=o<<8*(3-i%4)}return{value:t,binLen:4*c+n}}function c(e,t,n){var r,o,a,i,s=[],s=t||[0];for(n=n||0,o=n>>>3,r=0;r<e.length;r+=1)t=e.charCodeAt(r),i=r+o,a=i>>>2,s.length<=a&&s.push(0),s[a]|=t<<8*(3-i%4);return{value:s,binLen:8*e.length+n}}function u(e,t,n){var r,o,a,i,s,c,u=[],l=0,u=t||[0];if(n=n||0,t=n>>>3,-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(o=e.indexOf("="),e=e.replace(/\=/g,""),-1!==o&&o<e.length)throw Error("Invalid '=' found in base-64 string");for(o=0;o<e.length;o+=4){for(s=e.substr(o,4),a=i=0;a<s.length;a+=1)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(s[a]),i|=r<<18-6*a;for(a=0;a<s.length-1;a+=1){for(c=l+t,r=c>>>2;u.length<=r;)u.push(0);u[r]|=(i>>>16-8*a&255)<<8*(3-c%4),l+=1}}return{value:u,binLen:8*l+n}}function l(e,t,n){var r,o,a,i=[],i=t||[0];for(n=n||0,r=n>>>3,t=0;t<e.byteLength;t+=1)a=t+r,o=a>>>2,i.length<=o&&i.push(0),i[o]|=e[t]<<8*(3-a%4);return{value:i,binLen:8*e.byteLength+n}}function p(e,t,n){var r="";t/=8;var o,a;for(o=0;o<t;o+=1)a=e[o>>>2]>>>8*(3-o%4),r+="0123456789abcdef".charAt(a>>>4&15)+"0123456789abcdef".charAt(15&a);return n.outputUpper?r.toUpperCase():r}function f(e,t,n){var r,o,a,i="",s=t/8;for(r=0;r<s;r+=3)for(o=r+1<s?e[r+1>>>2]:0,a=r+2<s?e[r+2>>>2]:0,a=(e[r>>>2]>>>8*(3-r%4)&255)<<16|(o>>>8*(3-(r+1)%4)&255)<<8|a>>>8*(3-(r+2)%4)&255,o=0;4>o;o+=1)i+=8*r+6*o<=t?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6*(3-o)&63):n.b64Pad;return i}function h(e,t){var n,r,o="",a=t/8;for(n=0;n<a;n+=1)r=e[n>>>2]>>>8*(3-n%4)&255,o+=String.fromCharCode(r);return o}function d(e,t){var n,r=t/8,o=new ArrayBuffer(r);for(n=0;n<r;n+=1)o[n]=e[n>>>2]>>>8*(3-n%4)&255;return o}function m(e){var t={outputUpper:!1,b64Pad:"=",shakeLen:-1};if(e=e||{},t.outputUpper=e.outputUpper||!1,!0===e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad),!0===e.hasOwnProperty("shakeLen")){if(0!=e.shakeLen%8)throw Error("shakeLen must be a multiple of 8");t.shakeLen=e.shakeLen}if("boolean"!=typeof t.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw Error("Invalid b64Pad formatting option");return t}function b(e,t){var n;switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":n=s;break;case"TEXT":n=function(e,n,r){var o,a,i,s,c,u=[],l=[],p=0,u=n||[0];if(n=r||0,i=n>>>3,"UTF8"===t)for(o=0;o<e.length;o+=1)for(r=e.charCodeAt(o),l=[],128>r?l.push(r):2048>r?(l.push(192|r>>>6),l.push(128|63&r)):55296>r||57344<=r?l.push(224|r>>>12,128|r>>>6&63,128|63&r):(o+=1,r=65536+((1023&r)<<10|1023&e.charCodeAt(o)),l.push(240|r>>>18,128|r>>>12&63,128|r>>>6&63,128|63&r)),a=0;a<l.length;a+=1){for(c=p+i,s=c>>>2;u.length<=s;)u.push(0);u[s]|=l[a]<<8*(3-c%4),p+=1}else if("UTF16BE"===t||"UTF16LE"===t)for(o=0;o<e.length;o+=1){for(r=e.charCodeAt(o),"UTF16LE"===t&&(a=255&r,r=a<<8|r>>>8),c=p+i,s=c>>>2;u.length<=s;)u.push(0);u[s]|=r<<8*(2-c%4),p+=2}return{value:u,binLen:8*p+n}};break;case"B64":n=u;break;case"BYTES":n=c;break;case"ARRAYBUFFER":try{n=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}n=l;break;default:throw Error("format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER")}return n}function y(e,t){return e<<t|e>>>32-t}function g(e,t){return 32<t?(t-=32,new i(e.b<<t|e.a>>>32-t,e.a<<t|e.b>>>32-t)):0!==t?new i(e.a<<t|e.b>>>32-t,e.b<<t|e.a>>>32-t):e}function v(e,t){return e>>>t|e<<32-t}function w(e,t){var n=null,n=new i(e.a,e.b);return n=32>=t?new i(n.a>>>t|n.b<<32-t&4294967295,n.b>>>t|n.a<<32-t&4294967295):new i(n.b>>>t-32|n.a<<64-t&4294967295,n.a>>>t-32|n.b<<64-t&4294967295)}function E(e,t){return 32>=t?new i(e.a>>>t,e.b>>>t|e.a<<32-t&4294967295):new i(0,e.a>>>t-32)}function S(e,t,n){return e&t^~e&n}function C(e,t,n){return new i(e.a&t.a^~e.a&n.a,e.b&t.b^~e.b&n.b)}function O(e,t,n){return e&t^e&n^t&n}function k(e,t,n){return new i(e.a&t.a^e.a&n.a^t.a&n.a,e.b&t.b^e.b&n.b^t.b&n.b)}function T(e){return v(e,2)^v(e,13)^v(e,22)}function P(e){var t=w(e,28),n=w(e,34);return e=w(e,39),new i(t.a^n.a^e.a,t.b^n.b^e.b)}function N(e){return v(e,6)^v(e,11)^v(e,25)}function j(e){var t=w(e,14),n=w(e,18);return e=w(e,41),new i(t.a^n.a^e.a,t.b^n.b^e.b)}function _(e){return v(e,7)^v(e,18)^e>>>3}function A(e){var t=w(e,1),n=w(e,8);return e=E(e,7),new i(t.a^n.a^e.a,t.b^n.b^e.b)}function R(e){return v(e,17)^v(e,19)^e>>>10}function I(e){var t=w(e,19),n=w(e,61);return e=E(e,6),new i(t.a^n.a^e.a,t.b^n.b^e.b)}function D(e,t){var n=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(n>>>16)&65535)<<16|65535&n}function B(e,t,n,r){var o=(65535&e)+(65535&t)+(65535&n)+(65535&r);return((e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(o>>>16)&65535)<<16|65535&o}function M(e,t,n,r,o){var a=(65535&e)+(65535&t)+(65535&n)+(65535&r)+(65535&o);return((e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(o>>>16)+(a>>>16)&65535)<<16|65535&a}function F(e,t){var n,r,o;return n=(65535&e.b)+(65535&t.b),r=(e.b>>>16)+(t.b>>>16)+(n>>>16),o=(65535&r)<<16|65535&n,n=(65535&e.a)+(65535&t.a)+(r>>>16),r=(e.a>>>16)+(t.a>>>16)+(n>>>16),new i((65535&r)<<16|65535&n,o)}function x(e,t,n,r){var o,a,s;return o=(65535&e.b)+(65535&t.b)+(65535&n.b)+(65535&r.b),a=(e.b>>>16)+(t.b>>>16)+(n.b>>>16)+(r.b>>>16)+(o>>>16),s=(65535&a)<<16|65535&o,o=(65535&e.a)+(65535&t.a)+(65535&n.a)+(65535&r.a)+(a>>>16),a=(e.a>>>16)+(t.a>>>16)+(n.a>>>16)+(r.a>>>16)+(o>>>16),new i((65535&a)<<16|65535&o,s)}function V(e,t,n,r,o){var a,s,c;return a=(65535&e.b)+(65535&t.b)+(65535&n.b)+(65535&r.b)+(65535&o.b),s=(e.b>>>16)+(t.b>>>16)+(n.b>>>16)+(r.b>>>16)+(o.b>>>16)+(a>>>16),c=(65535&s)<<16|65535&a,a=(65535&e.a)+(65535&t.a)+(65535&n.a)+(65535&r.a)+(65535&o.a)+(s>>>16),s=(e.a>>>16)+(t.a>>>16)+(n.a>>>16)+(r.a>>>16)+(o.a>>>16)+(a>>>16),new i((65535&s)<<16|65535&a,c)}function L(e){var t,n=0,r=0;for(t=0;t<arguments.length;t+=1)n^=arguments[t].b,r^=arguments[t].a;return new i(r,n)}function U(e){var t,n=[];if("SHA-1"===e)n=[1732584193,4023233417,2562383102,271733878,3285377520];else if(0===e.lastIndexOf("SHA-",0))switch(n=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],t=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],e){case"SHA-224":break;case"SHA-256":n=t;break;case"SHA-384":n=[new i(3418070365,n[0]),new i(1654270250,n[1]),new i(2438529370,n[2]),new i(355462360,n[3]),new i(1731405415,n[4]),new i(41048885895,n[5]),new i(3675008525,n[6]),new i(1203062813,n[7])];break;case"SHA-512":n=[new i(t[0],4089235720),new i(t[1],2227873595),new i(t[2],4271175723),new i(t[3],1595750129),new i(t[4],2917565137),new i(t[5],725511199),new i(t[6],4215389547),new i(t[7],327033209)];break;default:throw Error("Unknown SHA variant")}else{if(0!==e.lastIndexOf("SHA3-",0)&&0!==e.lastIndexOf("SHAKE",0))throw Error("No SHA variants supported");for(e=0;5>e;e+=1)n[e]=[new i(0,0),new i(0,0),new i(0,0),new i(0,0),new i(0,0)]}return n}function q(e,t){var n,r,o,a,i,s,c,u=[];for(n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],c=0;80>c;c+=1)u[c]=16>c?e[c]:y(u[c-3]^u[c-8]^u[c-14]^u[c-16],1),s=20>c?M(y(n,5),r&o^~r&a,i,1518500249,u[c]):40>c?M(y(n,5),r^o^a,i,1859775393,u[c]):60>c?M(y(n,5),O(r,o,a),i,2400959708,u[c]):M(y(n,5),r^o^a,i,3395469782,u[c]),i=a,a=o,o=y(r,30),r=n,n=s;return t[0]=D(n,t[0]),t[1]=D(r,t[1]),t[2]=D(o,t[2]),t[3]=D(a,t[3]),t[4]=D(i,t[4]),t}function H(e,t,n,r){var o;for(o=15+(t+65>>>9<<4);e.length<=o;)e.push(0);for(e[t>>>5]|=128<<24-t%32,t+=n,e[o]=4294967295&t,e[o-1]=t/4294967296|0,t=e.length,o=0;o<t;o+=16)r=q(e.slice(o,o+16),r);return r}function W(e,t,n){var r,o,a,s,c,u,l,p,f,h,d,m,b,y,g,v,w,E,L,U,q,H,W,z=[];if("SHA-224"===n||"SHA-256"===n)h=64,m=1,H=Number,b=D,y=B,g=M,v=_,w=R,E=T,L=N,q=O,U=S,W=Q;else{if("SHA-384"!==n&&"SHA-512"!==n)throw Error("Unexpected error in SHA-2 implementation");h=80,m=2,H=i,b=F,y=x,g=V,v=A,w=I,E=P,L=j,q=k,U=C,W=Y}for(n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],c=t[5],u=t[6],l=t[7],d=0;d<h;d+=1)16>d?(f=d*m,p=e.length<=f?0:e[f],f=e.length<=f+1?0:e[f+1],z[d]=new H(p,f)):z[d]=y(w(z[d-2]),z[d-7],v(z[d-15]),z[d-16]),p=g(l,L(s),U(s,c,u),W[d],z[d]),f=b(E(n),q(n,r,o)),l=u,u=c,c=s,s=b(a,p),a=o,o=r,r=n,n=b(p,f);return t[0]=b(n,t[0]),t[1]=b(r,t[1]),t[2]=b(o,t[2]),t[3]=b(a,t[3]),t[4]=b(s,t[4]),t[5]=b(c,t[5]),t[6]=b(u,t[6]),t[7]=b(l,t[7]),t}function z(e,t){var n,r,o,a,s=[],c=[];if(null!==e)for(r=0;r<e.length;r+=2)t[(r>>>1)%5][(r>>>1)/5|0]=L(t[(r>>>1)%5][(r>>>1)/5|0],new i((255&e[r+1])<<24|(65280&e[r+1])<<8|(16711680&e[r+1])>>>8|e[r+1]>>>24,(255&e[r])<<24|(65280&e[r])<<8|(16711680&e[r])>>>8|e[r]>>>24));for(n=0;24>n;n+=1){for(a=U("SHA3-"),r=0;5>r;r+=1)s[r]=L(t[r][0],t[r][1],t[r][2],t[r][3],t[r][4]);for(r=0;5>r;r+=1)c[r]=L(s[(r+4)%5],g(s[(r+1)%5],1));for(r=0;5>r;r+=1)for(o=0;5>o;o+=1)t[r][o]=L(t[r][o],c[r]);for(r=0;5>r;r+=1)for(o=0;5>o;o+=1)a[o][(2*r+3*o)%5]=g(t[r][o],X[r][o]);for(r=0;5>r;r+=1)for(o=0;5>o;o+=1)t[r][o]=L(a[r][o],new i(~a[(r+1)%5][o].a&a[(r+2)%5][o].a,~a[(r+1)%5][o].b&a[(r+2)%5][o].b));t[0][0]=L(t[0][0],Z[n])}return t}var Q,Y,X,Z;Q=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Y=[new i(Q[0],3609767458),new i(Q[1],602891725),new i(Q[2],3964484399),new i(Q[3],2173295548),new i(Q[4],4081628472),new i(Q[5],3053834265),new i(Q[6],2937671579),new i(Q[7],3664609560),new i(Q[8],2734883394),new i(Q[9],1164996542),new i(Q[10],1323610764),new i(Q[11],3590304994),new i(Q[12],4068182383),new i(Q[13],991336113),new i(Q[14],633803317),new i(Q[15],3479774868),new i(Q[16],2666613458),new i(Q[17],944711139),new i(Q[18],2341262773),new i(Q[19],2007800933),new i(Q[20],1495990901),new i(Q[21],1856431235),new i(Q[22],3175218132),new i(Q[23],2198950837),new i(Q[24],3999719339),new i(Q[25],766784016),new i(Q[26],2566594879),new i(Q[27],3203337956),new i(Q[28],1034457026),new i(Q[29],2466948901),new i(Q[30],3758326383),new i(Q[31],168717936),new i(Q[32],1188179964),new i(Q[33],1546045734),new i(Q[34],1522805485),new i(Q[35],2643833823),new i(Q[36],2343527390),new i(Q[37],1014477480),new i(Q[38],1206759142),new i(Q[39],344077627),new i(Q[40],1290863460),new i(Q[41],3158454273),new i(Q[42],3505952657),new i(Q[43],106217008),new i(Q[44],3606008344),new i(Q[45],1432725776),new i(Q[46],1467031594),new i(Q[47],851169720),new i(Q[48],3100823752),new i(Q[49],1363258195),new i(Q[50],3750685593),new i(Q[51],3785050280),new i(Q[52],3318307427),new i(Q[53],3812723403),new i(Q[54],2003034995),new i(Q[55],3602036899),new i(Q[56],1575990012),new i(Q[57],1125592928),new i(Q[58],2716904306),new i(Q[59],442776044),new i(Q[60],593698344),new i(Q[61],3733110249),new i(Q[62],2999351573),new i(Q[63],3815920427),new i(3391569614,3928383900),new i(3515267271,566280711),new i(3940187606,3454069534),new i(4118630271,4000239992),new i(116418474,1914138554),new i(174292421,2731055270),new i(289380356,3203993006),new i(460393269,320620315),new i(685471733,587496836),new i(852142971,1086792851),new i(1017036298,365543100),new i(1126000580,2618297676),new i(1288033470,3409855158),new i(1501505948,4234509866),new i(1607167915,987167468),new i(1816402316,1246189591)],Z=[new i(0,1),new i(0,32898),new i(2147483648,32906),new i(2147483648,2147516416),new i(0,32907),new i(0,2147483649),new i(2147483648,2147516545),new i(2147483648,32777),new i(0,138),new i(0,136),new i(0,2147516425),new i(0,2147483658),new i(0,2147516555),new i(2147483648,139),new i(2147483648,32905),new i(2147483648,32771),new i(2147483648,32770),new i(2147483648,128),new i(0,32778),new i(2147483648,2147483658),new i(2147483648,2147516545),new i(2147483648,32896),new i(0,2147483649),new i(2147483648,2147516424)],X=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]],void 0!==(r=function(){return a}.call(t,n,t,e))&&(e.exports=r)}()},1294:function(e,t){},1295:function(e,t){},1296:function(e,t){},1320:function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var P,N,j,_,A,R,I,D,B,M,F,x,V=n(1),L=n.n(V),U=n(0),q=n.n(U),H=n(3),W=n(392),z=n(4),Q=n(39),Y=n.n(Q),X=n(7),Z=n(1130),K=n(1131),G=n(1133),J=n(1134),$=n(1129),ee=(n(1296),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),te=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ne=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["","s 后可重发"],["","s 后可重发"]),re=(N=P=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),te(t,[{key:"render",value:function(){var e=this.props,t=e.countDownEvent,n=e.startAtOnce,a=e.interceptTime,i=e.resetText,s=e.manualValidateError,c=e.onChange,u=e.validations,l=e.countDownEndEvent,p=e.reStartTime,f=o(e,["countDownEvent","startAtOnce","interceptTime","resetText","manualValidateError","onChange","validations","countDownEndEvent","reStartTime"]);return q.a.createElement("div",{className:"SignFlow SignFlow-smsInputContainer"},q.a.createElement($.a,ee({name:"digits",className:"SignFlow-smsInput",type:"number",errorMessageClassName:"SignFlow-smsBindPhoneInputErrorMask",placeholder:"输入 6 位验证码",manualValidateError:s,onChange:c,validations:[{type:"required",message:"请填写验证码",className:"SignFlow-smsInputBindPhoneRequiredErrorMask"}].concat(r(u||[]))},f)),q.a.createElement(G.a,{className:"SignFlow-smsInputButton",preset:"plain",initialText:"发送验证码",resetText:i,countingText:Object(J.a)(ne,"count"),startAtOnce:n,event:t,countDownEndEvent:l,interceptTime:a,reStartTime:p}))}}]),t}(U.Component),P.propTypes={countDownEvent:L.a.func.isRequired,startAtOnce:L.a.bool,interceptTime:L.a.number,resetText:L.a.string,manualValidateError:L.a.string},P.defaultProps={startAtOnce:!1,resetText:"重发验证码"},N),oe=re,ae=n(6),ie=(n(1135),n(1136),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()),se=(_=j=function(e){function t(){var e,n,r,o;u(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={selectedCountry:{code:"+86",name:"中国"},phoneNo:null,smsInputInterceptTime:-1,manualError:null,showFooter:!1,sendValidationCodeButtonText:"发送验证码",identifyingCodeError:null},r.testPhoneNo=function(){var e=r.state,t=e.selectedCountry.code,n=e.phoneNo,o=/^1[34578]\d{9}$/,a=/^\d+$/;return"+86"===t?o.test(n):a.test(n)},r.handleChange=function(e){return function(t){r.setState(c({},e,t))}},r.handleSendDigits=function(e){var t=r.props.requestPhoneVerificationCode,n=r.state,o=n.selectedCountry.code,a=n.phoneNo,i=n.manualError;if(X.default.trackEvent(e.target,{action:"GetCaptcha"}),r.testPhoneNo())return t(""+o+a).then(function(){r.setState({manualError:null})}).catch(function(e){var t=e.err;t=void 0===t?{}:t;var n=t.payload;n=void 0===n?{}:n;var o=n.message;return r.setState({manualError:o,smsInputInterceptTime:Date.now()})});return r.setState({manualError:"请输入正确的手机号"===i?" 请输入正确的手机号":"请输入正确的手机号",smsInputInterceptTime:Date.now()})},r.handleSubmit=function(e){var t=e.phoneNo,n=e.digits,o=r.props,a=o.updatePhoneNumber,i=o.onSuccess,s=o.onNeedUnbind,c=r.state,u=c.selectedCountry.code,l=c.identifyingCodeError;a(""+u+t,n).then(function(e){var n=e.payload,r=n.data;if(n.success)return i();var o=r.bindedAccountFullname,a=r.requestAccountFullname;return s({phoneNumber:t,bindName:o,requiredName:a})}).catch(function(e){var t=e.err;t=void 0===t?{}:t;var n=t.payload;n=void 0===n?{}:n;var o=n.code,a=n.message;o===ae.n&&r.setState({identifyingCodeError:l===a?" "+a:a})})},r.handleZaOK=function(e){X.default.trackEvent(e.target,{action:"Ok"})},r.renderContent=function(){var e=r.state,t=e.smsInputInterceptTime,n=e.manualError,o=e.sendValidationCodeButtonText,a=e.identifyingCodeError;return q.a.createElement("div",{ref:function(e){r.container=e}},q.a.createElement(Z.b,{className:"SignFlowActive SignFlow",onSubmit:r.handleSubmit},!1,q.a.createElement(K.a,{type:"register",supportedCountriesShown:!0,manualValidateError:n,onSelect:r.handleChange("selectedCountry"),onChange:r.handleChange("phoneNo")}),q.a.createElement(oe,{key:"sms-input",resetText:o,interceptTime:t,countDownEvent:r.handleSendDigits,manualValidateError:a}),q.a.createElement("div",{className:"BindPhone-helpWrapper"},q.a.createElement(z.default,{className:"BindPhone-helpText",preset:"link",onClick:function(){r.setState({showFooter:!0})}},"需要帮助？")),q.a.createElement(z.default,{className:"SignFlowActive-sendDigits",preset:"primary",color:"blue",type:"submit",onClick:r.handleZaOK},"确认")))},o=n,l(r,o)}return p(t,e),ie(t,[{key:"componentDidMount",value:function(){X.default.setModule(this.container,{module:"BindPhoneForm"}),X.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this.props.onClose,t=this.state.showFooter;return q.a.createElement(Y.a,{title:"设置手机号",subtitle:"绑定手机后，你就可以使用知乎的提问、回答、评论等功能。",footer:t?"如需要帮助，请联系 i@zhihu.com，我们会尽快帮你解决":null,onClose:e,size:"default"},this.renderContent())}}]),t}(U.Component),j.propTypes={requestPhoneVerificationCode:L.a.func.isRequired,updatePhoneNumber:L.a.func.isRequired,onClose:L.a.func.isRequired,onSuccess:L.a.func.isRequired,onNeedUnbind:L.a.func.isRequired},_),ce=n(12),ue=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),le=(R=A=function(e){function t(){var e,n,r,o;f(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.zaKnowMore=function(e){X.default.trackEvent(e.target,{action:"OpenUrl",name:"了解更多"})},r.toBindPhone=function(e){var t=r.props.onBindPhone;X.default.trackEvent(e.target,{action:"OpenUrl",name:"去绑定手机"}),t()},r.handleClose=function(e){var t=r.props,n=t.onClose,o=t.config.canWrite;X.default.trackEvent(e.target,{action:"Cancel",name:o?"暂不绑定":"取消"}),n()},r.renderContent=function(){var e=r.props.config,t=e.tip,n=e.canWrite;return q.a.createElement("div",{ref:function(e){r.container=e}},q.a.createElement("p",null,t,q.a.createElement(ce.a,{preset:"link",target:"_blank",href:"https://zhuanlan.zhihu.com/p/27257715",onClick:r.zaKnowMore},"了解更多")),q.a.createElement("div",{className:"BindPhone-buttonSection"},q.a.createElement(ce.a,{className:"BindPhone-button",onClick:r.handleClose},n?"暂不绑定":"取消"),q.a.createElement(z.default,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:r.toBindPhone},"去绑定手机")))},o=n,h(r,o)}return d(t,e),ue(t,[{key:"componentDidMount",value:function(){X.default.setModule(this.container,{module:"BindPhoneForm"}),X.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this.props.onClose;return q.a.createElement(Y.a,{className:!1,title:"绑定手机",onClose:e,size:"default"},this.renderContent())}}]),t}(U.Component),A.PropTypes={config:L.a.object,onClose:L.a.func,onBindPhone:L.a.func},R),pe=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),fe=(D=I=function(e){function t(){var e,n,r,o;m(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.handleCancel=function(e){var t=r.props.onClose;X.default.trackEvent(e.target,{action:"Cancel",name:"不绑定"}),t()},o=n,b(r,o)}return y(t,e),pe(t,[{key:"componentDidMount",value:function(){X.default.setModule(this.container,{module:"BindMailForm"}),X.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props.onClose;return q.a.createElement(Y.a,{className:!1,title:"手机号绑定成功",onClose:t,size:"default"},q.a.createElement("div",{ref:function(t){e.container=t}},q.a.createElement("p",null,"由于你此前绑定的邮箱未经验证，未来请使用手机号登录知乎。"),q.a.createElement(z.default,{className:"BindPhone-remindLoginWithPhoneButton",onClick:this.handleCancel,preset:"primary",color:"blue"},"知道了")))}}]),t}(U.Component),I.PropTypes={onClose:L.a.func},D),he=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),de=(M=B=function(e){function t(){var e,n,r,o;g(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.handleCancel=function(e){var t=r.props.onCancel;X.default.trackEvent(e.target,{action:"Click",name:"暂不绑定"}),t()},r.handleConfirm=function(e){var t=r.props.onConfirm;X.default.trackEvent(e.target,{action:"Click",name:"确认解绑"}),t()},o=n,v(r,o)}return w(t,e),he(t,[{key:"componentDidMount",value:function(){X.default.setModule(this.container,{module:"BindPhoneFailForm"}),X.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.phoneNumber,o=t.bindName,a=t.requiredName;return q.a.createElement(Y.a,{className:!1,title:"绑定失败",onClose:n,size:"default"},q.a.createElement("div",{ref:function(t){e.container=t}},q.a.createElement("p",null,"你所输入的手机号 ",r," 已经被绑定到帐号「",o,"」。"),!1,q.a.createElement("p",null,"你可以选择将该手机号从该帐号中解绑，并绑定至当前帐号「",a,"」。"),!1,q.a.createElement("p",null,q.a.createElement("b",null,"解绑后，你将无法再通过手机号登录原帐号「",o,"」。")),q.a.createElement("div",{className:"BindPhone-buttonSection"},q.a.createElement(z.default,{className:"BindPhone-button",onClick:this.handleConfirm},"确认解绑"),q.a.createElement(z.default,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel},"暂不绑定"))))}}]),t}(U.Component),B.PropTypes={onClose:L.a.func.isRequired,onCancel:L.a.func.isRequired,onConfirm:L.a.func.isRequired,phoneNumber:L.a.string.isRequired,bindName:L.a.string.isRequired,requiredName:L.a.string.isRequired},M),me=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),be=(x=F=function(e){function t(){var e,n,r,o;E(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=S(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.handleUnbind=function(e){var t=r.props,n=t.onSuccess,o=t.monopolizePhoneNumber,a=t.showNotification;X.default.trackEvent(e.target,{action:"Click",name:"确认解绑"}),o().then(function(){return a("绑定成功！","white"),n()})},r.handleCancel=function(e){var t=r.props.onCancel;X.default.trackEvent(e.target,{action:"Click",name:"暂不绑定"}),t()},o=n,S(r,o)}return C(t,e),me(t,[{key:"componentDidMount",value:function(){X.default.setModule(this.container,{module:"BindPhoneVerifyForm"}),X.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.bindName;return q.a.createElement(Y.a,{className:!1,title:"解绑手机",onClose:n,size:"default"},q.a.createElement("div",{ref:function(t){e.container=t}},q.a.createElement("p",null,q.a.createElement("b",null,"解绑操作无法撤销。")),!1,q.a.createElement("p",null,"如果你没有其他登录方式，你将无法再使用帐号「",r,"」。"),q.a.createElement("div",{className:"BindPhone-buttonSection"},q.a.createElement(z.default,{className:"BindPhone-button",onClick:this.handleUnbind},"确认解绑"),q.a.createElement(z.default,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel},"暂不绑定"))))}}]),t}(U.Component),F.PropTypes={onClose:L.a.func.isRequired,onSuccess:L.a.func.isRequired,onCancel:L.a.func.isRequired,bindName:L.a.string.isRequired,showNotification:L.a.func.isRequired,monopolizePhoneNumber:L.a.string.isRequired},x),ye=n(233),ge=n(13);n.d(t,"default",function(){return Pe});var ve,we,Ee,Se,Ce=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Oe="LOGIN_WITH_PHONE",ke="NEED_UNBIND",Te=function(e){var t=e.account,n=e.config,r=e.entities,o=r.users[e.currentUser],a=o.isActive,i=o.email;return{account:t,hasActiveEmail:a&&i,needShowLoginWithPhoneNumber:!a&&!!i,config:e.config,isWindow:n.isWindow}},Pe=(ve=Object(H.connect)(Te,{requestPhoneVerificationCode:ye.f,updatePhoneNumber:ye.j,monopolizePhoneNumber:ye.d,showNotification:ge.h,getUnlockRequest:ye.c,unlockTicketByDigits:ye.h,requestUnlockTicket:ye.g,unlockTicketByPassword:ye.i}))((Se=Ee=function(e){function t(){var e,n,r,o;O(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r=k(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={},r.handleBindPhoneSuccess=function(){var e=r.props,t=e.needShowLoginWithPhoneNumber,n=e.showNotification,o=e.onToggle;return t?r.goToStep(Oe)():(n("绑定成功！","white"),setTimeout(function(){return location.reload()},2e3),o())},r.handleNeedUnbind=function(e){var t=e.bindName,n=e.phoneNumber,o=e.requiredName;return r.setState({bindName:t,phoneNumber:n,requiredName:o,step:ke})},r.goToStep=function(e){return function(){return r.setState({step:e})}},r.handleCloseWithReload=function(){return location.reload()},o=n,k(r,o)}return T(t,e),Ce(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.getUnlockRequest,r=t.hasActiveEmail,o=t.shown,a=t.isWindow;if(e.shown&&!o){a||n();var i="";i=r?"CONFIRM_BIND_PHONE":a?"BIND_PHONE":"SAFETY_VERIFICATION",this.setState({step:i})}}},{key:"render",value:function(){var e=this.props,t=e.shown,n=e.requestPhoneVerificationCode,r=e.updatePhoneNumber,o=e.monopolizePhoneNumber,a=e.showNotification,i=e.config,s=e.account,c=e.isWindow,u=e.unlockTicketByDigits,l=e.requestUnlockTicket,p=e.unlockTicketByPassword,f=e.onToggle,h=this.state,d=h.step,m=h.bindName,b=h.phoneNumber,y=h.requiredName;return t?"CONFIRM_BIND_PHONE"===d?q.a.createElement(le,{onBindPhone:this.goToStep(c?"BIND_PHONE":"SAFETY_VERIFICATION"),onClose:f,config:i}):"BIND_PHONE"===d?q.a.createElement(se,{onClose:f,onSuccess:this.handleBindPhoneSuccess,onNeedUnbind:this.handleNeedUnbind,requestPhoneVerificationCode:n,updatePhoneNumber:r}):d===Oe?q.a.createElement(fe,{onClose:this.handleCloseWithReload}):d===ke?q.a.createElement(de,{onClose:f,onCancel:this.goToStep("BIND_PHONE"),onConfirm:this.goToStep("CONFIRM_UNBIND"),bindName:m,phoneNumber:b,requiredName:y}):"CONFIRM_UNBIND"===d?q.a.createElement(be,{onClose:f,onSuccess:this.handleBindPhoneSuccess,onCancel:this.goToStep("BIND_PHONE"),bindName:m,monopolizePhoneNumber:o,showNotification:a}):"SAFETY_VERIFICATION"===d?q.a.createElement(W.VerificationModal,{account:s,unlockTicketByDigits:u,requestUnlockTicket:l,unlockTicketByPassword:p,onClose:f,onSuccess:this.goToStep("BIND_PHONE"),zaModuleName:"BindMailForm"}):null:null}}]),t}(U.Component),Ee.propTypes={shown:L.a.bool.isRequired,onToggle:L.a.func.isRequired,needShowLoginWithPhoneNumber:L.a.bool.isRequired,config:L.a.object.isRequired,requestPhoneVerificationCode:L.a.func.isRequired,updatePhoneNumber:L.a.func.isRequired,monopolizePhoneNumber:L.a.func.isRequired},we=Se))||we}});
//# sourceMappingURL=main.signflow.4101884dc57b0552cabe.js.map